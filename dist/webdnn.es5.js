(function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t():'function'==typeof define&&define.amd?define([],t):'object'==typeof exports?exports.WebDNN=t():e.WebDNN=t()})('undefined'==typeof self?this:self,function(){var e=String.fromCharCode;return function(e){function t(r){if(a[r])return a[r].exports;var n=a[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var a={};return t.m=e,t.c=a,t.d=function(e,a,r){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var a=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(a,'a',a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=1)}([function(e,t){'use strict';function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var r='undefined'!=typeof Uint8Array&&'undefined'!=typeof Uint16Array&&'undefined'!=typeof Int32Array;t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if('object'!=typeof r)throw new TypeError(r+'must be non-object');for(var n in r)a(r,n)&&(e[n]=r[n])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,a,r,n){if(t.subarray&&e.subarray)return void e.set(t.subarray(a,a+r),n);for(var o=0;o<r;o++)e[n+o]=t[a+o]},flattenChunks:function(e){var t,a,r,n,o,l;for(r=0,t=0,a=e.length;t<a;t++)r+=e[t].length;for(l=new Uint8Array(r),n=0,(t=0,a=e.length);t<a;t++)o=e[t],l.set(o,n),n+=o.length;return l}},o={arraySet:function(e,t,a,r,n){for(var o=0;o<r;o++)e[n+o]=t[a+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,n)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(r)},function(e,t,a){'use strict';function r(){var e={webgpu:_.webgpu.checkAvailability(),webgl:_.webgl.checkAvailability(),webassembly:_.webassembly.checkAvailability(),fallback:_.fallback.checkAvailability()},t=['webgpu','webgl','webassembly','fallback'].filter(function(t){return e[t]});return{status:e,defaultOrder:t}}function n(e,t){return l(this,void 0,void 0,function(){var a,r;return i(this,function(n){switch(n.label){case 0:if(!(e in _))throw new Error('Unknown backend: "'+e+'"');n.label=1;case 1:return n.trys.push([1,3,,4]),a=new _[e](t),[4,a.init()];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),console.warn('Failed to initialize '+e+' backend: '+r),[2,null];case 4:return[2,a];}})})}var o=this&&this.__assign||Object.assign||function(e){for(var t=1,a=arguments.length,r;t<a;t++)for(var n in r=arguments[t],r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e},l=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var s=a(21),d=a(36),c=a(37),u=a(39),p=a(40);t.Image=p;var h=a(43);t.Math=h;var f={};t.getConfiguration=function(e,t){return e in f?f[e]:t},t.setConfiguration=function(e,t){f[e]=t};var _={webgpu:u.default,webgl:c.default,webassembly:d.default,fallback:s.default};t.getBackendAvailability=r,t.load=function(e,t){return void 0===t&&(t={}),l(this,void 0,void 0,function(){var a,l,s,d,c,u,p,h,f,_,g,m,b,y,v,w,x,E,k,I,C,T;return i(this,function(i){switch(i.label){case 0:a=t.backendOrder,l=void 0===a?null:a,s=t.backendOptions,d=void 0===s?{}:s,c=t.cacheStrategy,u=void 0===c?'latest':c,p=t.saveCache,h=void 0===p||p,f=t.progressCallback,_=t.weightDirectory,g=t.transformUrlDelegate,l||(l=r().defaultOrder),'string'==typeof l&&(l=[l]),l=l.slice(),-1===l.indexOf('fallback')&&l.concat(['fallback']),m=function(t){return _&&/\.bin/.test(t)&&(t=t.replace(e,_)),g&&(t=g(t)),t},i.label=1;case 1:return 0<l.length?(b=l.shift(),y=o({},d[b]),y.transformUrlDelegate=m,[4,n(b,y)]):[3,36];case 2:if(v=i.sent(),!v)return[3,1];i.label=3;case 3:return i.trys.push([3,34,,35]),w=void 0,x=void 0,E=void 0,k=void 0,I=u,'latest'===I?[3,4]:'networkOnly'===I?[3,13]:'networkFirst'===I?[3,13]:'cacheOnly'===I?[3,20]:'cacheFirst'===I?[3,20]:[3,27];case 4:return[4,v.fetchDescriptor(e).catch(function(){return null})];case 5:return E=i.sent(),[4,v.restoreCachedDescriptor(e)];case 6:return(k=i.sent(),!(k&&E&&k.converted_at===E.converted_at))?[3,8]:(w=k,[4,v.restoreCachedParameters(e,f)]);case 7:if(x=i.sent(),x)return[3,28];i.label=8;case 8:return E?(w=E,[4,v.fetchParameters(e,f)]):[3,10];case 9:if(x=i.sent(),x)return[3,28];i.label=10;case 10:return k?(w=k,[4,v.restoreCachedParameters(e,f)]):[3,12];case 11:if(x=i.sent(),x)return[3,28];i.label=12;case 12:throw Error('Network error is occurred and no cache is exist.');case 13:return[4,v.fetchDescriptor(e).catch(function(){return null})];case 14:return(E=i.sent(),!E)?[3,16]:(w=E,[4,v.fetchParameters(e,f)]);case 15:if(x=i.sent(),x)return[3,28];i.label=16;case 16:if('networkOnly'===u)throw Error('Network error is occurred in "networkOnly" cache strategy');return[4,v.restoreCachedDescriptor(e)];case 17:return(k=i.sent(),!k)?[3,19]:(w=k,[4,v.restoreCachedParameters(e,f)]);case 18:if(x=i.sent(),x)return[3,28];i.label=19;case 19:throw Error('Network error is occurred and no cache is exist.');case 20:return[4,v.restoreCachedDescriptor(e)];case 21:return(k=i.sent(),!k)?[3,23]:(w=k,[4,v.restoreCachedParameters(e,f)]);case 22:if(x=i.sent(),x)return[3,28];i.label=23;case 23:if('cacheOnly'===u)throw Error('No cache is exist in "cacheOnly" cache strategy');return[4,v.fetchDescriptor(e).catch(function(){return null})];case 24:return(E=i.sent(),!E)?[3,26]:(w=E,[4,v.fetchParameters(e,f)]);case 25:if(x=i.sent(),x)return[3,28];i.label=26;case 26:throw Error('Network error is occurred and no cache is exist.');case 27:throw Error('"'+u+'" is not valid cache strategy name: "latest", "networkFirst", "networkOnly", "cacheFirst", "cacheOnly" is available.');case 28:if(!h)return[3,32];i.label=29;case 29:return i.trys.push([29,31,,32]),[4,v.saveCache(e,w,x)];case 30:return i.sent(),[3,32];case 31:return C=i.sent(),[3,32];case 32:return[4,v.setDescriptorAndParameters(w,x)];case 33:return i.sent(),[3,35];case 34:return T=i.sent(),console.warn('Model loading failed for '+b+' backend. Trying next backend: '+T.message),[3,1];case 35:return[2,v];case 36:throw new Error('No backend is available');}})})}},function(e,t,a){(function(t){var a,a;/*!
    localForage -- Offline Storage, Improved
    Version 1.7.1
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(t){e.exports=t()})(function(){return function d(c,e,t){function r(i,o){if(!e[i]){if(!c[i]){if(!o&&'function'==typeof a&&a)return a(i,!0);if(n)return n(i,!0);var s=new Error('Cannot find module \''+i+'\'');throw s.code='MODULE_NOT_FOUND',s}var p=e[i]={exports:{}};c[i][0].call(p.exports,function(t){var e=c[i][1][t];return r(e?e:t)},p,p.exports,d,c,e,t)}return e[i].exports}for(var n='function'==typeof a&&a,l=0;l<t.length;l++)r(t[l]);return r}({1:[function(e,a){(function(e){'use strict';function t(){c=!0;for(var e=d.length,t,a;e;){for(a=d,d=[],t=-1;++t<e;)a[t]();e=d.length}c=!1}var r=e.MutationObserver||e.WebKitMutationObserver,n;if(r){var o=0,l=new r(t),i=e.document.createTextNode('');l.observe(i,{characterData:!0}),n=function(){i.data=o=++o%2}}else if(!e.setImmediate&&'undefined'!=typeof e.MessageChannel){var s=new e.MessageChannel;s.port1.onmessage=t,n=function(){s.port2.postMessage(0)}}else n='document'in e&&'onreadystatechange'in e.document.createElement('script')?function(){var a=e.document.createElement('script');a.onreadystatechange=function(){t(),a.onreadystatechange=null,a.parentNode.removeChild(a),a=null},e.document.documentElement.appendChild(a)}:function(){setTimeout(t,0)};var d=[],c;a.exports=function(e){1!==d.push(e)||c||n()}}).call(this,'undefined'==typeof t?'undefined'==typeof self?'undefined'==typeof window?{}:window:self:t)},{}],2:[function(e,t){'use strict';function a(){}function r(e){if('function'!=typeof e)throw new TypeError('resolver must be a function');this.state=h,this.queue=[],this.outcome=void 0,e!==a&&s(this,e)}function n(e,t,a){this.promise=e,'function'==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),'function'==typeof a&&(this.onRejected=a,this.callRejected=this.otherCallRejected)}function o(t,e,a){i(function(){var r;try{r=e(a)}catch(a){return c.reject(t,a)}r===t?c.reject(t,new TypeError('Cannot resolve promise with itself')):c.resolve(t,r)})}function l(e){var t=e&&e.then;if(e&&('object'==typeof e||'function'==typeof e)&&'function'==typeof t)return function(){t.apply(e,arguments)}}function s(e,t){function a(t){n||(n=!0,c.reject(e,t))}function r(t){n||(n=!0,c.resolve(e,t))}var n=!1,o=d(function(){t(r,a)});'error'===o.status&&a(o.value)}function d(e,t){var a={};try{a.value=e(t),a.status='success'}catch(t){a.status='error',a.value=t}return a}var i=e(1),c={},u=['REJECTED'],p=['FULFILLED'],h=['PENDING'];t.exports=r,r.prototype['catch']=function(e){return this.then(null,e)},r.prototype.then=function(e,t){if('function'!=typeof e&&this.state===p||'function'!=typeof t&&this.state===u)return this;var r=new this.constructor(a);if(this.state!==h){var l=this.state===p?e:t;o(r,l,this.outcome)}else this.queue.push(new n(r,e,t));return r},n.prototype.callFulfilled=function(e){c.resolve(this.promise,e)},n.prototype.otherCallFulfilled=function(e){o(this.promise,this.onFulfilled,e)},n.prototype.callRejected=function(e){c.reject(this.promise,e)},n.prototype.otherCallRejected=function(e){o(this.promise,this.onRejected,e)},c.resolve=function(e,t){var a=d(l,t);if('error'===a.status)return c.reject(e,a.value);var r=a.value;if(r)s(e,r);else{e.state=p,e.outcome=t;for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callFulfilled(t)}return e},c.reject=function(e,t){e.state=u,e.outcome=t;for(var a=-1,r=e.queue.length;++a<r;)e.queue[a].callRejected(t);return e},r.resolve=function(e){return e instanceof this?e:c.resolve(new this(a),e)},r.reject=function(e){var t=new this(a);return c.reject(t,e)},r.all=function(e){function t(e,t){r.resolve(e).then(function(e){l[t]=e,++s!==n||o||(o=!0,c.resolve(u,l))},function(e){o||(o=!0,c.reject(u,e))})}var r=this;if('[object Array]'!==Object.prototype.toString.call(e))return this.reject(new TypeError('must be an array'));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var l=Array(n),s=0,d=-1,u=new this(a);++d<n;)t(e[d],d);return u},r.race=function(e){function t(e){r.resolve(e).then(function(e){o||(o=!0,c.resolve(i,e))},function(e){o||(o=!0,c.reject(i,e))})}var r=this;if('[object Array]'!==Object.prototype.toString.call(e))return this.reject(new TypeError('must be an array'));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var l=-1,i=new this(a);++l<n;)t(e[l]);return i}},{1:1}],3:[function(e){(function(t){'use strict';'function'!=typeof t.Promise&&(t.Promise=e(2))}).call(this,'undefined'==typeof t?'undefined'==typeof self?'undefined'==typeof window?{}:window:self:t)},{2:2}],4:[function(e,t){'use strict';function a(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function r(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if('TypeError'!==o.name)throw o;for(var a='undefined'==typeof BlobBuilder?'undefined'==typeof MSBlobBuilder?'undefined'==typeof MozBlobBuilder?WebKitBlobBuilder:MozBlobBuilder:MSBlobBuilder:BlobBuilder,r=new a,n=0;n<e.length;n+=1)r.append(e[n]);return r.getBlob(t.type)}}function o(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function n(e,t,a){'function'==typeof t&&e.then(t),'function'==typeof a&&e['catch'](a)}function l(e){return'string'!=typeof e&&(console.warn(e+' used as a key, but it is not a string.'),e+=''),e}function i(){if(arguments.length&&'function'==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function s(e){for(var t=e.length,a=new ArrayBuffer(t),r=new Uint8Array(a),n=0;n<t;n++)r[n]=e.charCodeAt(n);return a}function d(e){return new M(function(t){var a=e.transaction(F,H),n=r(['']);a.objectStore(F).put(n,'key'),a.onabort=function(a){a.preventDefault(),a.stopPropagation(),t(!1)},a.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),a=navigator.userAgent.match(/Edge\//);t(a||!e||43<=parseInt(e[1],10))}})['catch'](function(){return!1})}function c(e){return'boolean'==typeof Ee?M.resolve(Ee):d(e).then(function(e){return Ee=e,Ee})}function u(e){var t=U[e.name],a={};a.promise=new M(function(e,t){a.resolve=e,a.reject=t}),t.deferredOperations.push(a),t.dbReady=t.dbReady?t.dbReady.then(function(){return a.promise}):a.promise}function p(e){var t=U[e.name],a=t.deferredOperations.pop();if(a)return a.resolve(),a.promise}function h(e,t){var a=U[e.name],r=a.deferredOperations.pop();if(r)return r.reject(t),r.promise}function f(t,e){return new M(function(a,r){if(U[t.name]=U[t.name]||k(),t.db)if(e)u(t),t.db.close();else return a(t.db);var n=[t.name];e&&n.push(t.version);var o=L.open.apply(L,n);e&&(o.onupgradeneeded=function(a){var e=o.result;try{e.createObjectStore(t.storeName),1>=a.oldVersion&&e.createObjectStore(F)}catch(e){if('ConstraintError'===e.name)console.warn('The database "'+t.name+'" has been upgraded from version '+a.oldVersion+' to version '+a.newVersion+', but the storage "'+t.storeName+'" already exists.');else throw e}}),o.onerror=function(t){t.preventDefault(),r(o.error)},o.onsuccess=function(){a(o.result),p(t)}})}function _(e){return f(e,!1)}function g(e){return f(e,!0)}function m(e,t){if(!e.db)return!0;var a=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,n=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+'" can\'t be downgraded from version '+e.db.version+' to version '+e.version+'.'),e.version=e.db.version),n||a){if(a){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function b(t){return new M(function(a,e){var r=new FileReader;r.onerror=e,r.onloadend=function(r){var e=btoa(r.target.result||'');a({__local_forage_encoded_blob:!0,data:e,type:t.type})},r.readAsBinaryString(t)})}function y(e){var t=s(atob(e.data));return r([t],{type:e.type})}function v(e){return e&&e.__local_forage_encoded_blob}function w(e){var t=this,a=t._initReady().then(function(){var e=U[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return n(a,e,e),a}function x(e){u(e);for(var t=U[e.name],a=t.forages,r=0,n;r<a.length;r++)n=a[r],n._dbInfo.db&&(n._dbInfo.db.close(),n._dbInfo.db=null);return e.db=null,_(e).then(function(t){return e.db=t,m(e)?g(e):t}).then(function(r){e.db=t.db=r;for(var n=0;n<a.length;n++)a[n]._dbInfo.db=r})['catch'](function(t){throw h(e,t),t})}function E(e,t,a,r){r===void 0&&(r=1);try{var n=e.db.transaction(e.storeName,t);a(null,n)}catch(n){if(0<r&&(!e.db||'InvalidStateError'===n.name||'NotFoundError'===n.name))return M.resolve().then(function(){if(!e.db||'NotFoundError'===n.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),g(e)}).then(function(){return x(e).then(function(){E(e,t,a,r-1)})})['catch'](a);a(n)}}function k(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function I(e){var t=0.75*e.length,a=e.length,r=0,n,o,l,i,s;'='===e[e.length-1]&&(t--,'='===e[e.length-2]&&t--);var d=new ArrayBuffer(t),c=new Uint8Array(d);for(n=0;n<a;n+=4)o=V.indexOf(e[n]),l=V.indexOf(e[n+1]),i=V.indexOf(e[n+2]),s=V.indexOf(e[n+3]),c[r++]=o<<2|l>>4,c[r++]=(15&l)<<4|i>>2,c[r++]=(3&i)<<6|63&s;return d}function C(e){var t=new Uint8Array(e),a='',r;for(r=0;r<t.length;r+=3)a+=V[t[r]>>2],a+=V[(3&t[r])<<4|t[r+1]>>4],a+=V[(15&t[r+1])<<2|t[r+2]>>6],a+=V[63&t[r+2]];return 2==t.length%3?a=a.substring(0,a.length-1)+'=':1==t.length%3&&(a=a.substring(0,a.length-2)+'=='),a}function T(e,t,a,r){e.executeSql('CREATE TABLE IF NOT EXISTS '+t.storeName+' (id INTEGER PRIMARY KEY, key unique, value)',[],a,r)}function S(e,a,r,n,o,l){e.executeSql(r,n,o,function(e,i){i.code===i.SYNTAX_ERR?e.executeSql('SELECT name FROM sqlite_master WHERE type=\'table\' AND name = ?',[name],function(e,t){t.rows.length?l(e,i):T(e,a,function(){e.executeSql(r,n,o,l)},l)},l):l(e,i)},l)}function R(e,t,a,r){var n=this;e=l(e);var i=new M(function(o,l){n.ready().then(function(){void 0===t&&(t=null);var i=t,s=n._dbInfo;s.serializer.serialize(t,function(d,t){t?l(t):s.db.transaction(function(a){S(a,s,'INSERT OR REPLACE INTO '+s.storeName+' (key, value) VALUES (?, ?)',[e,d],function(){o(i)},function(e,t){l(t)})},function(t){if(t.code===t.QUOTA_ERR){if(0<r)return void o(R.apply(n,[e,i,a,r-1]));l(t)}})})})['catch'](l)});return o(i,a),i}function D(e){return new M(function(a,r){e.transaction(function(n){n.executeSql('SELECT name FROM sqlite_master WHERE type=\'table\' AND name <> \'__WebKitDatabaseInfoTable__\'',[],function(r,t){for(var n=[],o=0;o<t.rows.length;o++)n.push(t.rows.item(o).name);a({db:e,storeNames:n})},function(e,t){r(t)})},function(e){r(e)})})}function B(e,t){var a=e.name+'/';return e.storeName!==t.storeName&&(a+=e.storeName+'/'),a}function P(){var e='_localforage_support_test';try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(t){return!0}}function A(){return!P()||0<localStorage.length}function z(e,t){e[t]=function(){var a=arguments;return e.ready().then(function(){return e[t].apply(e,a)})}}function N(){for(var e=1,t;e<arguments.length;e++)if(t=arguments[e],t)for(var a in t)t.hasOwnProperty(a)&&(arguments[0][a]=he(t[a])?t[a].slice():t[a]);return arguments[0]}var O='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},L=function(){try{if('undefined'!=typeof indexedDB)return indexedDB;if('undefined'!=typeof webkitIndexedDB)return webkitIndexedDB;if('undefined'!=typeof mozIndexedDB)return mozIndexedDB;if('undefined'!=typeof OIndexedDB)return OIndexedDB;if('undefined'!=typeof msIndexedDB)return msIndexedDB}catch(t){}}();'undefined'==typeof Promise&&e(3);var M=Promise,F='local-forage-detect-blob-support',U={},W=Object.prototype.toString,j='readonly',H='readwrite',G={_driver:'asyncStorage',_initStorage:function(e){function t(){return M.resolve()}var a=this,r={db:null};if(e)for(var n in e)r[n]=e[n];var o=U[r.name];o||(o=k(),U[r.name]=o),o.forages.push(a),a._initReady||(a._initReady=a.ready,a.ready=w);for(var l=[],i=0,s;i<o.forages.length;i++)s=o.forages[i],s!==a&&l.push(s._initReady()['catch'](t));var d=o.forages.slice(0);return M.all(l).then(function(){return r.db=o.db,_(r)}).then(function(e){return r.db=e,m(r,a._defaultConfig.version)?g(r):e}).then(function(e){r.db=o.db=e,a._dbInfo=r;for(var t=0,n;t<d.length;t++)n=d[t],n!==a&&(n._dbInfo.db=r.db,n._dbInfo.version=r.version)})},_support:function(){try{if(!L)return!1;var e='undefined'!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t='function'==typeof fetch&&-1!==fetch.toString().indexOf('[native code');return(!e||t)&&'undefined'!=typeof indexedDB&&'undefined'!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(e,t){var a=this,r=new M(function(t,r){a.ready().then(function(){E(a._dbInfo,j,function(n,o){if(n)return r(n);try{var l=o.objectStore(a._dbInfo.storeName),i=l.openCursor(),s=1;i.onsuccess=function(){var a=i.result;if(a){var r=a.value;v(r)&&(r=y(r));var n=e(r,a.key,s++);void 0===n?a['continue']():t(n)}else t()},i.onerror=function(){r(i.error)}}catch(t){r(t)}})})['catch'](r)});return o(r,t),r},getItem:function(e,t){var a=this;e=l(e);var r=new M(function(t,r){a.ready().then(function(){E(a._dbInfo,j,function(n,o){if(n)return r(n);try{var l=o.objectStore(a._dbInfo.storeName),i=l.get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),v(e)&&(e=y(e)),t(e)},i.onerror=function(){r(i.error)}}catch(t){r(t)}})})['catch'](r)});return o(r,t),r},setItem:function(e,t,a){var r=this;e=l(e);var n=new M(function(a,n){var o;r.ready().then(function(){return o=r._dbInfo,'[object Blob]'===W.call(t)?c(o.db).then(function(e){return e?t:b(t)}):t}).then(function(t){E(r._dbInfo,H,function(o,l){if(o)return n(o);try{var i=l.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var s=i.put(t,e);l.oncomplete=function(){void 0===t&&(t=null),a(t)},l.onabort=l.onerror=function(){var e=s.error?s.error:s.transaction.error;n(e)}}catch(t){n(t)}})})['catch'](n)});return o(n,a),n},removeItem:function(e,t){var a=this;e=l(e);var r=new M(function(t,r){a.ready().then(function(){E(a._dbInfo,H,function(n,o){if(n)return r(n);try{var l=o.objectStore(a._dbInfo.storeName),i=l['delete'](e);o.oncomplete=function(){t()},o.onerror=function(){r(i.error)},o.onabort=function(){var e=i.error?i.error:i.transaction.error;r(e)}}catch(t){r(t)}})})['catch'](r)});return o(r,t),r},clear:function(e){var t=this,a=new M(function(e,a){t.ready().then(function(){E(t._dbInfo,H,function(r,n){if(r)return a(r);try{var o=n.objectStore(t._dbInfo.storeName),l=o.clear();n.oncomplete=function(){e()},n.onabort=n.onerror=function(){var e=l.error?l.error:l.transaction.error;a(e)}}catch(t){a(t)}})})['catch'](a)});return o(a,e),a},length:function(e){var t=this,a=new M(function(e,a){t.ready().then(function(){E(t._dbInfo,j,function(r,n){if(r)return a(r);try{var o=n.objectStore(t._dbInfo.storeName),l=o.count();l.onsuccess=function(){e(l.result)},l.onerror=function(){a(l.error)}}catch(t){a(t)}})})['catch'](a)});return o(a,e),a},key:function(e,t){var a=this,r=new M(function(t,r){return 0>e?void t(null):void a.ready().then(function(){E(a._dbInfo,j,function(n,o){if(n)return r(n);try{var l=o.objectStore(a._dbInfo.storeName),i=!1,s=l.openCursor();s.onsuccess=function(){var a=s.result;return a?void(0===e?t(a.key):i?t(a.key):(i=!0,a.advance(e))):void t(null)},s.onerror=function(){r(s.error)}}catch(t){r(t)}})})['catch'](r)});return o(r,t),r},keys:function(e){var t=this,a=new M(function(e,a){t.ready().then(function(){E(t._dbInfo,j,function(r,n){if(r)return a(r);try{var o=n.objectStore(t._dbInfo.storeName),l=o.openCursor(),i=[];l.onsuccess=function(){var t=l.result;return t?void(i.push(t.key),t['continue']()):void e(i)},l.onerror=function(){a(l.error)}}catch(t){a(t)}})})['catch'](a)});return o(a,e),a},dropInstance:function(e,t){t=i.apply(this,arguments);var a=this.config();e='function'!=typeof e&&e||{},e.name||(e.name=e.name||a.name,e.storeName=e.storeName||a.storeName);var r=this,n;if(!e.name)n=M.reject('Invalid arguments');else{var l=e.name===a.name&&r._dbInfo.db,s=l?M.resolve(r._dbInfo.db):_(e).then(function(t){var a=U[e.name],r=a.forages;a.db=t;for(var n=0;n<r.length;n++)r[n]._dbInfo.db=t;return t});n=e.storeName?s.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var a=t.version+1;u(e);var r=U[e.name],n=r.forages;t.close();for(var o=0,l;o<n.length;o++)l=n[o],l._dbInfo.db=null,l._dbInfo.version=a;var i=new M(function(t,r){var n=L.open(e.name,a);n.onerror=function(e){var t=n.result;t.close(),r(e)},n.onupgradeneeded=function(){var t=n.result;t.deleteObjectStore(e.storeName)},n.onsuccess=function(){var e=n.result;e.close(),t(e)}});return i.then(function(e){r.db=e;for(var t=0,a;t<n.length;t++)a=n[t],a._dbInfo.db=e,p(a._dbInfo)})['catch'](function(t){throw(h(e,t)||M.resolve())['catch'](function(){}),t})}}):s.then(function(t){u(e);var a=U[e.name],r=a.forages;t.close();for(var n=0,o;n<r.length;n++)o=r[n],o._dbInfo.db=null;var l=new M(function(t,a){var r=L.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),a(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}});return l.then(function(e){a.db=e;for(var t=0,n;t<r.length;t++)n=r[t],p(n._dbInfo)})['catch'](function(t){throw(h(e,t)||M.resolve())['catch'](function(){}),t})})}return o(n,t),n}},V='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',X=/^~~local_forage_type~([^~]+)~/,Y='__lfsc__:',Z=Y.length,K='arbf',q='blob',Q='si08',J='ui08',$='uic8',ee='si16',te='si32',ae='ur16',re='ui32',ne='fl32',oe='fl64',le=Z+K.length,ie=Object.prototype.toString,se={serialize:function(t,a){var e='';if(t&&(e=ie.call(t)),t&&('[object ArrayBuffer]'===e||t.buffer&&'[object ArrayBuffer]'===ie.call(t.buffer))){var r=Y,n;t instanceof ArrayBuffer?(n=t,r+=K):(n=t.buffer,'[object Int8Array]'===e?r+=Q:'[object Uint8Array]'===e?r+=J:'[object Uint8ClampedArray]'===e?r+=$:'[object Int16Array]'===e?r+=ee:'[object Uint16Array]'===e?r+=ae:'[object Int32Array]'===e?r+=te:'[object Uint32Array]'===e?r+=re:'[object Float32Array]'===e?r+=ne:'[object Float64Array]'===e?r+=oe:a(new Error('Failed to get type for BinaryArray'))),a(r+C(n))}else if('[object Blob]'===e){var o=new FileReader;o.onload=function(){var e='~~local_forage_type~'+t.type+'~'+C(this.result);a(Y+q+e)},o.readAsArrayBuffer(t)}else try{a(JSON.stringify(t))}catch(r){console.error('Couldn\'t convert value into a JSON string: ',t),a(null,r)}},deserialize:function(e){if(e.substring(0,Z)!==Y)return JSON.parse(e);var t=e.substring(le),a=e.substring(Z,le),n;if(a===q&&X.test(t)){var o=t.match(X);n=o[1],t=t.substring(o[0].length)}var l=I(t);switch(a){case K:return l;case q:return r([l],{type:n});case Q:return new Int8Array(l);case J:return new Uint8Array(l);case $:return new Uint8ClampedArray(l);case ee:return new Int16Array(l);case ae:return new Uint16Array(l);case te:return new Int32Array(l);case re:return new Uint32Array(l);case ne:return new Float32Array(l);case oe:return new Float64Array(l);default:throw new Error('Unkown type: '+a);}},stringToBuffer:I,bufferToString:C},de={_driver:'webSQLStorage',_initStorage:function(e){var t=this,a={db:null};if(e)for(var r in e)a[r]='string'==typeof e[r]?e[r]:e[r].toString();var n=new M(function(e,r){try{a.db=openDatabase(a.name,a.version+'',a.description,a.size)}catch(t){return r(t)}a.db.transaction(function(n){T(n,a,function(){t._dbInfo=a,e()},function(e,t){r(t)})},r)});return a.serializer=se,n},_support:function(){return'function'==typeof openDatabase}(),iterate:function(e,t){var a=this,r=new M(function(r,n){a.ready().then(function(){var o=a._dbInfo;o.db.transaction(function(a){S(a,o,'SELECT * FROM '+o.storeName,[],function(a,t){for(var n=t.rows,l=n.length,s=0;s<l;s++){var i=n.item(s),d=i.value;if(d&&(d=o.serializer.deserialize(d)),d=e(d,i.key,s+1),void 0!==d)return void r(d)}r()},function(e,t){n(t)})})})['catch'](n)});return o(r,t),r},getItem:function(e,t){var a=this;e=l(e);var r=new M(function(r,n){a.ready().then(function(){var o=a._dbInfo;o.db.transaction(function(a){S(a,o,'SELECT * FROM '+o.storeName+' WHERE key = ? LIMIT 1',[e],function(e,t){var a=t.rows.length?t.rows.item(0).value:null;a&&(a=o.serializer.deserialize(a)),r(a)},function(e,t){n(t)})})})['catch'](n)});return o(r,t),r},setItem:function(e,t,a){return R.apply(this,[e,t,a,1])},removeItem:function(e,t){var a=this;e=l(e);var r=new M(function(t,r){a.ready().then(function(){var n=a._dbInfo;n.db.transaction(function(a){S(a,n,'DELETE FROM '+n.storeName+' WHERE key = ?',[e],function(){t()},function(e,t){r(t)})})})['catch'](r)});return o(r,t),r},clear:function(e){var t=this,a=new M(function(e,a){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(n){S(n,r,'DELETE FROM '+r.storeName,[],function(){e()},function(e,t){a(t)})})})['catch'](a)});return o(a,e),a},length:function(e){var t=this,a=new M(function(e,a){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(n){S(n,r,'SELECT COUNT(key) as c FROM '+r.storeName,[],function(a,t){var r=t.rows.item(0).c;e(r)},function(e,t){a(t)})})})['catch'](a)});return o(a,e),a},key:function(e,t){var a=this,r=new M(function(r,n){a.ready().then(function(){var o=a._dbInfo;o.db.transaction(function(a){S(a,o,'SELECT key FROM '+o.storeName+' WHERE id = ? LIMIT 1',[e+1],function(e,t){var a=t.rows.length?t.rows.item(0).key:null;r(a)},function(e,t){n(t)})})})['catch'](n)});return o(r,t),r},keys:function(e){var t=this,a=new M(function(e,a){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(n){S(n,r,'SELECT key FROM '+r.storeName,[],function(a,t){for(var r=[],n=0;n<t.rows.length;n++)r.push(t.rows.item(n).key);e(r)},function(e,t){a(t)})})})['catch'](a)});return o(a,e),a},dropInstance:function(e,t){t=i.apply(this,arguments);var a=this.config();e='function'!=typeof e&&e||{},e.name||(e.name=e.name||a.name,e.storeName=e.storeName||a.storeName);var r=this,n;return n=e.name?new M(function(t){var n;n=e.name===a.name?r._dbInfo.db:openDatabase(e.name,'','',0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(D(n))}).then(function(e){return new M(function(t,a){e.db.transaction(function(r){function n(e){return new M(function(t,a){r.executeSql('DROP TABLE IF EXISTS '+e,[],function(){t()},function(e,t){a(t)})})}for(var o=[],l=0,i=e.storeNames.length;l<i;l++)o.push(n(e.storeNames[l]));M.all(o).then(function(){t()})['catch'](function(t){a(t)})},function(e){a(e)})})}):M.reject('Invalid arguments'),o(n,t),n}},ce={_driver:'localStorageWrapper',_initStorage:function(e){var t=this,a={};if(e)for(var r in e)a[r]=e[r];return(a.keyPrefix=B(e,t._defaultConfig),!A())?M.reject():(t._dbInfo=a,a.serializer=se,M.resolve())},_support:function(){try{return'undefined'!=typeof localStorage&&'setItem'in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(e,t){var a=this,r=a.ready().then(function(){for(var t=a._dbInfo,r=t.keyPrefix,n=r.length,o=localStorage.length,l=1,s=0,i;s<o;s++)if(i=localStorage.key(s),0===i.indexOf(r)){var d=localStorage.getItem(i);if(d&&(d=t.serializer.deserialize(d)),d=e(d,i.substring(n),l++),void 0!==d)return d}});return o(r,t),r},getItem:function(e,t){var a=this;e=l(e);var r=a.ready().then(function(){var t=a._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r});return o(r,t),r},setItem:function(e,t,a){var r=this;e=l(e);var n=r.ready().then(function(){void 0===t&&(t=null);var a=t;return new M(function(n,o){var l=r._dbInfo;l.serializer.serialize(t,function(t,r){if(r)o(r);else try{localStorage.setItem(l.keyPrefix+e,t),n(a)}catch(t){('QuotaExceededError'===t.name||'NS_ERROR_DOM_QUOTA_REACHED'===t.name)&&o(t),o(t)}})})});return o(n,a),n},removeItem:function(e,t){var a=this;e=l(e);var r=a.ready().then(function(){var t=a._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return o(r,t),r},clear:function(e){var t=this,a=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,a=localStorage.length-1,r;0<=a;a--)r=localStorage.key(a),0===r.indexOf(e)&&localStorage.removeItem(r)});return o(a,e),a},length:function(e){var t=this,a=t.keys().then(function(e){return e.length});return o(a,e),a},key:function(e,t){var a=this,r=a.ready().then(function(){var t=a._dbInfo,r;try{r=localStorage.key(e)}catch(e){r=null}return r&&(r=r.substring(t.keyPrefix.length)),r});return o(r,t),r},keys:function(e){var t=this,a=t.ready().then(function(){for(var e=t._dbInfo,a=localStorage.length,r=[],n=0,o;n<a;n++)o=localStorage.key(n),0===o.indexOf(e.keyPrefix)&&r.push(o.substring(e.keyPrefix.length));return r});return o(a,e),a},dropInstance:function(e,t){if(t=i.apply(this,arguments),e='function'!=typeof e&&e||{},!e.name){var a=this.config();e.name=e.name||a.name,e.storeName=e.storeName||a.storeName}var r=this,n;return n=e.name?new M(function(t){e.storeName?t(B(e,r._defaultConfig)):t(e.name+'/')}).then(function(e){for(var t=localStorage.length-1,a;0<=t;t--)a=localStorage.key(t),0===a.indexOf(e)&&localStorage.removeItem(a)}):M.reject('Invalid arguments'),o(n,t),n}},ue=function(e,t){return e===t||'number'==typeof e&&'number'==typeof t&&isNaN(e)&&isNaN(t)},pe=function(e,t){for(var a=e.length,r=0;r<a;){if(ue(e[r],t))return!0;r++}return!1},he=Array.isArray||function(e){return'[object Array]'===Object.prototype.toString.call(e)},fe={},_e={},ge={INDEXEDDB:G,WEBSQL:de,LOCALSTORAGE:ce},me=[ge.INDEXEDDB._driver,ge.WEBSQL._driver,ge.LOCALSTORAGE._driver],be=['dropInstance'],ye=['clear','getItem','iterate','key','keys','length','removeItem','setItem'].concat(be),ve={description:'',driver:me.slice(),name:'localforage',size:4980736,storeName:'keyvaluepairs',version:1},we=function(){function e(t){for(var r in a(this,e),ge)if(ge.hasOwnProperty(r)){var n=ge[r],o=n._driver;this[r]=o,fe[o]||this.defineDriver(n)}this._defaultConfig=N({},ve),this._config=N({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)['catch'](function(){})}return e.prototype.config=function(e){if('object'===('undefined'==typeof e?'undefined':O(e))){if(this._ready)return new Error('Can\'t call config() after localforage has been used.');for(var t in e){if('storeName'==t&&(e[t]=e[t].replace(/\W/g,'_')),'version'==t&&'number'!=typeof e[t])return new Error('Database version must be a number.');this._config[t]=e[t]}return'driver'in e&&e.driver?this.setDriver(this._config.driver):!0}return'string'==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,a){var r=new M(function(t,a){try{var r=e._driver,n=new Error('Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver');if(!e._driver)return void a(n);for(var l=ye.concat('_initStorage'),s=0,i=l.length;s<i;s++){var d=l[s],c=!pe(be,d);if((c||e[d])&&'function'!=typeof e[d])return void a(n)}var u=function(){for(var t=function(e){return function(){var t=new Error('Method '+e+' is not implemented by the current driver'),a=M.reject(t);return o(a,arguments[arguments.length-1]),a}},a=0,r=be.length,n;a<r;a++)n=be[a],e[n]||(e[n]=t(n))};u();var p=function(a){fe[r]&&console.info('Redefining LocalForage driver: '+r),fe[r]=e,_e[r]=a,t()};'_support'in e?e._support&&'function'==typeof e._support?e._support().then(p,a):p(!!e._support):p(!0)}catch(t){a(t)}});return n(r,t,a),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,a){var r=fe[e]?M.resolve(fe[e]):M.reject(new Error('Driver not found.'));return n(r,t,a),r},e.prototype.getSerializer=function(e){var t=M.resolve(se);return n(t,e),t},e.prototype.ready=function(e){var t=this,a=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return n(a,e,e),a},e.prototype.setDriver=function(e,t,a){function r(){i._config.driver=i.driver()}function o(e){return i._extend(e),r(),i._ready=i._initStorage(i._config),i._ready}function l(e){return function(){function t(){for(;a<e.length;){var n=e[a];return a++,i._dbInfo=null,i._ready=null,i.getDriver(n).then(o)['catch'](t)}r();var l=new Error('No available storage method found.');return i._driverSet=M.reject(l),i._driverSet}var a=0;return t()}}var i=this;he(e)||(e=[e]);var s=this._getSupportedDrivers(e),d=null===this._driverSet?M.resolve():this._driverSet['catch'](function(){return M.resolve()});return this._driverSet=d.then(function(){var e=s[0];return i._dbInfo=null,i._ready=null,i.getDriver(e).then(function(e){i._driver=e._driver,r(),i._wrapLibraryMethodsWithReady(),i._initDriver=l(s)})})['catch'](function(){r();var e=new Error('No available storage method found.');return i._driverSet=M.reject(e),i._driverSet}),n(this._driverSet,t,a),this._driverSet},e.prototype.supports=function(e){return!!_e[e]},e.prototype._extend=function(e){N(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],a=0,r=e.length,n;a<r;a++)n=e[a],this.supports(n)&&t.push(n);return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=ye.length;e<t;e++)z(this,ye[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),xe=new we,Ee;t.exports=xe},{3:3}]},{},[4])(4)})}).call(t,a(22))},function(e,t,a){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var r=a(23),n=a(33);t.default=function(e){switch(e){case'raw':return new n.default;case'eightbit':return new r.default;default:throw new Error('Unknown weight encoding');}}},function(e,t,a){'use strict';function r(){if(!window.hasOwnProperty('ProgressEvent')||!window.hasOwnProperty('FormData'))return!1;var e=new XMLHttpRequest;if('string'==typeof e.responseType)try{return e.responseType='blob','blob'===e.responseType}catch(t){return!1}else return!1}function n(e,t){return new Promise(function(a,r){var n=new XMLHttpRequest;n.open('GET',e,!0),n.responseType='blob';var o=new i.default;n.onload=function(){o.forceDispatch();var e=new Response(n.response);a(e)},n.onprogress=function(e){t&&o.request(function(){return t(e.loaded,e.total)})},n.onerror=function(e){r(e)},n.send(null)})}var o=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var i=a(34);t.default=function(e,t,a){return o(this,void 0,void 0,function(){var o;return l(this,function(l){switch(l.label){case 0:return e='string'==typeof e?t(e)+(a&&a.ignoreCache?'?t='+Date.now():''):Object.assign({},e,{url:t(e.url)+(a&&a.ignoreCache?'?t='+Date.now():'')}),'string'==typeof e&&r()?[4,n(e,a&&a.progressCallback)]:[3,2];case 1:return o=l.sent(),[3,4];case 2:return[4,fetch(e,a)];case 3:o=l.sent(),l.label=4;case 4:if(!o.ok)throw new Error('Fetch returns status code '+o.status+': '+o.statusText);return[2,o];}})})},t.readArrayBufferProgressively=function(e,t){function a(e){return o.set(e.value,l),l+=e.value.length,t&&d.request(function(){return t(l,n)}),l==n?(d.forceDispatch(),o.buffer):s.read().then(a)}if(!t||!e.body)return e.arrayBuffer();var r=e.headers.get('Content-Length');if(!r)return e.arrayBuffer();var n=parseInt(r),o=new Uint8Array(n),l=0,s=e.body.getReader(),d=new i.default;return s.read().then(a)}},function(e,t,a){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var r=function(){function e(e){this.values={},e&&this.update(e)}return Object.defineProperty(e.prototype,'isResolved',{get:function(){return Object.values(this.values).every(function(e){return'number'==typeof e})},enumerable:!0,configurable:!0}),e.prototype.update=function(e){this.values=Object.assign(this.values,e)},e.prototype.resolve=function(e){var t=this;if('object'!=typeof e)return e;if(1==Object.keys(e).length&&'eval'in e){if(!this.isResolved)throw Error('Not all placeholders are resolved: '+this);return eval('(function(placeholders){return '+e.eval+';})')(this.values)}return e instanceof Array?e.map(function(e){return t.resolve(e)}):Object.entries(e).reduce(function(e,a){var r=a[0],n=a[1];return e[r]=t.resolve(n),e},{})},e.prototype.toString=function(){return JSON.stringify(this.values)},e}();t.default=r},function(e,t,a){'use strict';var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}();Object.defineProperty(t,'__esModule',{value:!0});var n=a(35),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.BYTES_PER_ELEMENT=4,t}return r(t,e),t.prototype.toActual=function(){if(!this.buffer)throw new Error('Internal buffer for this variable is not set. DescriptorRunner.setPlaceholderValue() have to be called before calling this function.');return new Float32Array(this.buffer,this.byteOffset,this.length)},t.prototype.every=function(e,t){return this.toActual().every(e,t)},t.prototype.filter=function(e,t){return this.toActual().filter(e,t)},t.prototype.find=function(e,t){return this.toActual().find(e,t)},t.prototype.findIndex=function(e,t){return this.toActual().findIndex(e,t)},t.prototype.forEach=function(e,t){return this.toActual().forEach(e,t)},t.prototype.map=function(e,t){return this.toActual().map(e,t)},t.prototype.reduce=function(e,t){return this.toActual().reduce(e,t)},t.prototype.reduceRight=function(e,t){return this.toActual().reduceRight(e,t)},t.prototype.reverse=function(){return this.toActual().reverse()},t.prototype.slice=function(e,t){return this.toActual().slice(e,t)},t.prototype.some=function(e,t){return this.toActual().some(e,t)},t.prototype.subarray=function(e,t){return this.toActual().subarray(e,t)},t.prototype.includes=function(e,t){return this.toActual().includes(e,t)},t.BYTES_PER_ELEMENT=4,t}(n.SymbolicTypedArray);t.default=o},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=function(){function e(e){void 0===e&&(e={}),this.descriptor=null;var t=e.transformUrlDelegate,a=void 0===t?function(e){return e}:t;this.transformUrlDelegate=a}return e.checkAvailability=function(){return!1},e}();t.DescriptorRunner=a},function(e){'use strict';e.exports={0:'',1:'stream end',2:'need dictionary',"-1":'file error',"-2":'stream error',"-3":'data error',"-4":'insufficient memory',"-5":'buffer error',"-6":'incompatible version'}},function(e){'use strict';e.exports=function(e,t,a,r){for(var o=0|65535&e,l=0|65535&e>>>16,i=0;0!==a;){i=2e3<a?2e3:a,a-=i;do o=0|o+t[r++],l=0|l+o;while(--i);o%=65521,l%=65521}return 0|(o|l<<16)}},function(e){'use strict';var t=function(){for(var e=[],t=0,a;256>t;t++){a=t;for(var r=0;8>r;r++)a=1&a?3988292384^a>>>1:a>>>1;e[t]=a}return e}();e.exports=function(e,a,r,n){e^=-1;for(var o=n;o<n+r;o++)e=e>>>8^t[255&(e^a[o])];return-1^e}},function(t,a,r){'use strict';function n(t,a){if(65537>a&&(t.subarray&&s||!t.subarray&&l))return e.apply(null,o.shrinkBuf(t,a));for(var r='',n=0;n<a;n++)r+=e(t[n]);return r}var o=r(0),l=!0,s=!0;try{e.apply(null,[0])}catch(e){l=!1}try{e.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var d=new o.Buf8(256),i=0;256>i;i++)d[i]=252<=i?6:248<=i?5:240<=i?4:224<=i?3:192<=i?2:1;d[254]=d[254]=1,a.string2buf=function(e){var t=e.length,a=0,r,n,l,s,d;for(s=0;s<t;s++)n=e.charCodeAt(s),55296==(64512&n)&&s+1<t&&(l=e.charCodeAt(s+1),56320==(64512&l)&&(n=65536+(n-55296<<10)+(l-56320),s++)),a+=128>n?1:2048>n?2:65536>n?3:4;for(r=new o.Buf8(a),d=0,s=0;d<a;s++)n=e.charCodeAt(s),55296==(64512&n)&&s+1<t&&(l=e.charCodeAt(s+1),56320==(64512&l)&&(n=65536+(n-55296<<10)+(l-56320),s++)),128>n?r[d++]=n:2048>n?(r[d++]=192|n>>>6,r[d++]=128|63&n):65536>n?(r[d++]=224|n>>>12,r[d++]=128|63&n>>>6,r[d++]=128|63&n):(r[d++]=240|n>>>18,r[d++]=128|63&n>>>12,r[d++]=128|63&n>>>6,r[d++]=128|63&n);return r},a.buf2binstring=function(e){return n(e,e.length)},a.binstring2buf=function(e){for(var t=new o.Buf8(e.length),a=0,r=t.length;a<r;a++)t[a]=e.charCodeAt(a);return t},a.buf2string=function(e,t){var a=t||e.length,r=Array(2*a),o,l,i,s;for(l=0,o=0;o<a;){if(i=e[o++],128>i){r[l++]=i;continue}if(s=d[i],4<s){r[l++]=65533,o+=s-1;continue}for(i&=2===s?31:3===s?15:7;1<s&&o<a;)i=i<<6|63&e[o++],s--;if(1<s){r[l++]=65533;continue}65536>i?r[l++]=i:(i-=65536,r[l++]=55296|1023&i>>10,r[l++]=56320|1023&i)}return n(r,l)},a.utf8border=function(e,t){var a;for(t=t||e.length,t>e.length&&(t=e.length),a=t-1;0<=a&&128==(192&e[a]);)a--;return 0>a?t:0===a?t:a+d[e[a]]>t?a:t}},function(e){'use strict';e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg='',this.state=null,this.data_type=2,this.adler=0}},function(e){'use strict';e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,a){'use strict';function r(e){return'WebGL2RenderingContext'===e.constructor.name}function n(e){if(null===e)throw Error('Null is detected');return e}var o=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var i=a(1);t.isWebGL2=r;var s=function(){function e(){this.gl=n(e.initializeContext())}return e.getInstance=function(){return d||(d=new e),d},e.prototype.createTexture=function(e,t,a,r){var o=this.gl,l=n(o.createTexture());return o.activeTexture(o.TEXTURE0+9),o.bindTexture(o.TEXTURE_2D,l),o.texImage2D(o.TEXTURE_2D,0,a,e,t,0,r,o.FLOAT,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.bindTexture(o.TEXTURE_2D,null),l},e.prototype.createVertexShader=function(e){return this.createShader(this.gl.VERTEX_SHADER,e)},e.prototype.createFragmentShader=function(e){return this.createShader(this.gl.FRAGMENT_SHADER,e)},e.prototype.createShader=function(e,t){var a=n(this.gl.createShader(e));if(this.gl.shaderSource(a,t),this.gl.compileShader(a),!this.gl.getShaderParameter(a,this.gl.COMPILE_STATUS))throw console.error(this.gl.getShaderInfoLog(a)),Error('Shader Compile failed: '+this.gl.getShaderInfoLog(a));return a},e.prototype.createProgram=function(e,t){var a=n(this.gl.createProgram());if(this.gl.attachShader(a,t),this.gl.attachShader(a,e),this.gl.linkProgram(a),!this.gl.getProgramParameter(a,this.gl.LINK_STATUS))throw console.error(this.gl.getProgramInfoLog(a)),Error('ShaderProgram Initialization failed.');return a},e.prototype.createArrayBuffer=function(e){var t=n(this.gl.createBuffer());return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),t},e.prototype.createFrameBuffer=function(){return n(this.gl.createFramebuffer())},e.prototype.bindArrayBuffer=function(e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e)},e.prototype.bindFrameBuffer=function(e,t,a){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.viewport(0,0,t,a),this.gl.scissor(0,0,t,a)},e.prototype.useProgram=function(e){this.gl.useProgram(e)},e.prototype.deleteTexture=function(e){this.gl.deleteTexture(e)},e.initializeWebGL2Context=function(e){void 0===e&&(e=document.createElement('canvas'));var t;return t=e.getContext('webgl2'),t?t.getExtension('EXT_color_buffer_float')?i.getConfiguration('DEBUG',!1)&&!t.getExtension('WEBGL_debug_renderer_info')?null:t:null:null},e.initializeWebGL1Context=function(t){void 0===t&&(t=document.createElement('canvas'));var a=t.getContext('webgl')||t.getContext('experimental-webgl');return a?a.getExtension('OES_texture_float')?e.IS_SAFARI?null:i.getConfiguration('DEBUG',!1)&&!a.getExtension('WEBGL_debug_renderer_info')?null:a:null:null},e.initializeContext=function(){var t=document.createElement('canvas'),a;if(a=e.initializeWebGL2Context(t),a)i.getConfiguration('DEBUG',!1)&&console.info('WebGL2 is enabled');else if(a=e.initializeWebGL1Context(t),a)i.getConfiguration('DEBUG',!1)&&console.info('WebGL2 is disabled');else return null;return a.disable(a.DEPTH_TEST),a.disable(a.STENCIL_TEST),a.disable(a.BLEND),a.disable(a.DITHER),a.disable(a.POLYGON_OFFSET_FILL),a.disable(a.SAMPLE_COVERAGE),a.enable(a.SCISSOR_TEST),a.enable(a.CULL_FACE),a.cullFace(a.BACK),a},e.checkAvailability=function(){if(null===c){var t=e.initializeContext();c=!!t&&!(4096>i.getConfiguration('MAX_TEXTURE_SIZE',t.getParameter(t.MAX_TEXTURE_SIZE)))}return c},e.prototype.waitForComplete=function(){return o(this,void 0,void 0,function(){var e,t,a;return l(this,function(n){switch(n.label){case 0:if(e=this.gl,!r(e))return[3,4];t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0),a=e.clientWaitSync(t,0,0),n.label=1;case 1:return a===e.CONDITION_SATISFIED||a===e.ALREADY_SIGNALED?[3,3]:[4,new Promise(function(e){return setTimeout(e,1)})];case 2:return n.sent(),a=e.clientWaitSync(t,0,0),[3,1];case 3:return e.deleteSync(t),[3,5];case 4:e.finish(),n.label=5;case 5:return[2];}})})},Object.defineProperty(e.prototype,'MAX_TEXTURE_SIZE',{get:function(){var e=i.getConfiguration('MAX_TEXTURE_SIZE',this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE));if(16384<=e)return 4096;if(8192<=e)return 4096;if(4096<=e)return 4096;throw new Error('MAX_TEXTURE_SIZE is too small: '+e)},enumerable:!0,configurable:!0}),e.IS_SAFARI=-1!==navigator.userAgent.toLowerCase().indexOf('safari')&&-1===navigator.userAgent.toLowerCase().indexOf('chrome'),e}(),d;t.default=s;var c=null},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=function(){return function(e,t){this.byteLength=e,this.backend=t}}();t.Buffer=a},function(e,t,a){'use strict';var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),n=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var l=a(17),i=a(15),s=function(e){function t(t){var a=e.call(this,t,'webgpu')||this;return 0==t&&(t=4),a.handler=l.default.getInstance(),a.buffer=a.handler.createBuffer(new Uint8Array(t)),a.bufferView=new Uint8Array(a.buffer.contents),a}return r(t,e),t.prototype.write=function(e,t){return n(this,void 0,void 0,function(){var a;return o(this,function(r){switch(r.label){case 0:return[4,this.handler.sync()];case 1:return r.sent(),a=new e.constructor(this.bufferView.buffer),a.set(e,t),[2];}})})},t.prototype.read=function(e,t,a){return void 0===t&&(t=0),n(this,void 0,void 0,function(){var r,n;return o(this,function(o){switch(o.label){case 0:if(!e)throw new Error('dst cannot be null');return[4,this.handler.sync()];case 1:return(o.sent(),0===this.byteLength)?[2]:(r=e.constructor,n=new r(this.bufferView.buffer,this.bufferView.byteOffset+t*r.BYTES_PER_ELEMENT,a),e.set(n),[2]);}})})},t.prototype.getWriteView=function(e,t,a){return new a(this.bufferView.buffer,this.bufferView.byteOffset+e*a.BYTES_PER_ELEMENT,t)},t.prototype.getReadView=function(e,t,a){return new a(this.bufferView.buffer,this.bufferView.byteOffset+e*a.BYTES_PER_ELEMENT,t)},t.prototype.syncWriteViews=function(){return n(this,void 0,void 0,function(){return o(this,function(){return[2]})})},t.prototype.syncReadViews=function(){return n(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.handler.sync()];case 1:return e.sent(),[2];}})})},t}(i.Buffer);t.default=s},function(e,t,a){'use strict';var r=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var o=a(16),l=function(){function e(){if(this.pipelineStates=new Map,!t.IS_WEBGPU_SUPPORTED)throw new Error('This browser does not support WebGPU');var e;try{e=document.createElement('canvas').getContext('webgpu')}catch(e){throw new Error('During initializing WebGPURenderingContext, unexpected error is occurred: '+e.message)}if(!e)throw new Error('WebGPURenderingContext initialization failed');this.context=e,this.commandQueue=e.createCommandQueue(),this.loadKernel('kernel void sync(){}','basic')}return e.getInstance=function(){return i||(i=new e),i},e.prototype.createBuffer=function(e){return this.context.createBuffer(e)},e.prototype.loadKernel=function(e,t){void 0===t&&(t='');for(var a=this.context.createLibrary(e),r=0,n=a.functionNames;r<n.length;r++){var o=n[r],l=a.functionWithName(o),i=this.context.createComputePipelineState(l);this.pipelineStates.set(t+'.'+o,i)}},e.prototype.createCommandBuffer=function(){return this.commandQueue.createCommandBuffer()},e.prototype.getPipelineStateByName=function(e){var t=this.pipelineStates.get(e);if(!t)throw TypeError('Kernel function "'+e+'" is not loaded.');return t},e.prototype.executeSinglePipelineState=function(e,t,a,r,n){var l=this.commandBuffer||(this.commandBuffer=this.createCommandBuffer()),s=l.createComputeCommandEncoder();s.setComputePipelineState(this.getPipelineStateByName(e));for(var d=0;d<r.length;d++){var i=r[d],c=void 0;c=i instanceof o.default?i.buffer:i,s.setBuffer(c,0,d)}s.dispatch(t,a),s.endEncoding();var u=null;return n&&(u=l.completed),this.commandBuffer=null,l.commit(),u},e.prototype.sync=function(){return r(this,void 0,void 0,function(){var e,t,a;return n(this,function(){return e=this.createCommandBuffer(),t=e.createComputeCommandEncoder(),t.setComputePipelineState(this.getPipelineStateByName('basic.sync')),t.dispatch({width:1,height:1,depth:1},{width:1,height:1,depth:1}),t.endEncoding(),a=e.completed,e.commit(),[2,a]})})},e}(),i;t.default=l,t.IS_WEBGPU_SUPPORTED='WebGPURenderingContext'in window&&'WebGPUComputeCommandEncoder'in window},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a;(function(e){e[e.CHW=0]='CHW',e[e.HWC=1]='HWC'})(a=t.Order||(t.Order={}));var r;(function(e){e[e.RGB=0]='RGB',e[e.BGR=1]='BGR',e[e.GREY=2]='GREY',e[e.RGBA=3]='RGBA',e[e.BGRA=4]='BGRA'})(r=t.Color||(t.Color={}))},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.getContext2D=function(e){var t=e.getContext('2d');if(!t)throw Error('CanvasRenderingContext2D initialization failed');return t}},function(e,t){'use strict';function a(e){return n(this,void 0,void 0,function(){var t;return o(this,function(){return t=document.createElement('img'),[2,new Promise(function(a,r){t.onload=a,t.onerror=r,t.src=e}).then(function(){return t})]})})}function r(e){return n(this,void 0,void 0,function(){var t,r;return o(this,function(){if(t=e.files,!t||0==t.length)throw new Error('No file is selected');return r=URL.createObjectURL(t[0]),[2,a(r)]})})}var n=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0}),t.loadImageByUrl=a,t.loadImageFromFileInput=r,t.loadImageByDialog=function(){return n(this,void 0,void 0,function(){var e;return o(this,function(){return e=document.createElement('input'),e.type='file',e.accept='image/*',[2,new Promise(function(t){e.onchange=function(){return t(r(e))},e.click()})]})})}},function(e,t,a){'use strict';function r(e){return void 0===e&&(e=10),new Promise(function(t){return setTimeout(t,e)})}var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var i=a(2),s=a(3),d=a(4),c=a(5),u=a(6),p=a(7),h=function(e){function t(t){void 0===t&&(t={});var a=e.call(this,t)||this;return a.backendName='fallback',a}return n(t,e),t.checkAvailability=function(){return!0},t.prototype.init=function(){return o(this,void 0,void 0,function(){return l(this,function(){return[2]})})},t.prototype.setDescriptorAndParameters=function(e,t){return o(this,void 0,void 0,function(){return l(this,function(a){switch(a.label){case 0:return this.setDescriptor(e),[4,this.compile()];case 1:return a.sent(),[4,this.initializeStaticBuffer(t)];case 2:return a.sent(),this.placeholderContext&&this.placeholderContext.isResolved?[4,this.initializeDynamicBuffer()]:[3,4];case 3:a.sent(),a.label=4;case 4:return[2];}})})},t.prototype.fetchDescriptor=function(e){return o(this,void 0,void 0,function(){var t;return l(this,function(a){switch(a.label){case 0:return this.directory=e,[4,d.default(e+'/graph_'+this.backendName+'.json',this.transformUrlDelegate)];case 1:return t=a.sent(),[2,t.json()];}})})},t.prototype.fetchParameters=function(e,t){return o(this,void 0,void 0,function(){var a;return l(this,function(r){switch(r.label){case 0:return[4,d.default(e+'/weight_'+this.backendName+'.bin',this.transformUrlDelegate)];case 1:return a=r.sent(),[2,d.readArrayBufferProgressively(a,t)];}})})},t.prototype.restoreCachedDescriptor=function(e){return o(this,void 0,void 0,function(){return l(this,function(){return[2,i.getItem(e+'_'+this.backendName+'_descriptor').catch(function(){return null})]})})},t.prototype.restoreCachedParameters=function(e,t){return o(this,void 0,void 0,function(){var a;return l(this,function(r){switch(r.label){case 0:return[4,i.getItem(e+'_'+this.backendName+'_parameters').catch(function(){return null})];case 1:return a=r.sent(),a&&t&&t(a.byteLength,a.byteLength),[2,a];}})})},t.prototype.saveCache=function(e,t,a){return o(this,void 0,void 0,function(){return l(this,function(r){switch(r.label){case 0:return[4,Promise.all([i.setItem(e+'_'+this.backendName+'_descriptor',t),i.setItem(e+'_'+this.backendName+'_parameters',a)])];case 1:return r.sent(),[2];}})})},(t.prototype.setDescriptor=function(e){this.descriptor=e,this.placeholderContext=new c.default,this.placeholderContext.update(e.placeholders),this.kernelObj=null,this.variableMap=null,this.staticBuffer=null,this.dynamicBuffer=null},t.prototype.compile=function(){return o(this,void 0,void 0,function(){var e=this;return l(this,function(t){switch(t.label){case 0:if(!this.descriptor)throw new Error('Descriptor is not loaded');return[4,new Promise(function(t){var a=document.createElement('script');a.type='text/javascript',a.readyState?a.onreadystatechange=function(){('loaded'==a.readyState||'complete'==a.readyState)&&(a.onreadystatechange=null,t())}:a.onload=t,a.src=e.transformUrlDelegate(e.directory+'/kernels_fallback.js'),document.getElementsByTagName('head')[0].appendChild(a)})];case 1:return t.sent(),this.kernelObj=window.dnn_fallback_kernel,[2];}})})},t.prototype.initializeStaticBuffer=function(e){return o(this,void 0,void 0,function(){var t,a,r,n,o,i;return l(this,function(l){switch(l.label){case 0:if(!this.descriptor)throw new Error('Descriptor is not loaded');return t=this.descriptor,a=new Float32Array(t.memory_layout.static.size),this.staticBuffer=a,r=this.variableMap||new Map,this.variableMap=r,Object.entries(t.memory_layout.static.allocations).forEach(function(e){var t=e[0],n=e[1];r.set(t,new Float32Array(a.buffer,n.offset*Float32Array.BYTES_PER_ELEMENT,n.size))}),n=s.default(this.descriptor.weight_encoding),i=(o=a).set,[4,n.decode(new Uint8Array(e))];case 1:return i.apply(o,[l.sent()]),[4,this.getInputViews()];case 2:return l.sent().filter(function(e){return!e.isDynamic}).forEach(function(e){e.buffer=a.buffer}),[4,this.getOutputViews()];case 3:return l.sent().filter(function(e){return!e.isDynamic}).forEach(function(e){e.buffer=a.buffer}),[2];}})})},t.prototype.initializeDynamicBuffer=function(){return o(this,void 0,void 0,function(){var e,t,a,r;return l(this,function(n){switch(n.label){case 0:if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');return e=this.descriptor,t=this.placeholderContext,a=new Float32Array(t.resolve(e.memory_layout.dynamic.size)),this.dynamicBuffer=a,r=this.variableMap||new Map,this.variableMap=r,Object.entries(e.memory_layout.dynamic.allocations).forEach(function(e){var n=e[0],o=e[1];r.set(n,new Float32Array(a.buffer,t.resolve(o.offset)*Float32Array.BYTES_PER_ELEMENT,t.resolve(o.size)))}),[4,this.getInputViews()];case 1:return n.sent().filter(function(e){return e.isDynamic}).forEach(function(e){e.buffer=a.buffer}),[4,this.getOutputViews()];case 2:return n.sent().filter(function(e){return e.isDynamic}).forEach(function(e){e.buffer=a.buffer}),[2];}})})},t.prototype.setPlaceholderValue=function(e){return o(this,void 0,void 0,function(){var t;return l(this,function(a){switch(a.label){case 0:if(!this.placeholderContext)throw new Error('placeholderContext is not initialized');return t=this.placeholderContext,t.update(e),t.isResolved?[4,this.initializeDynamicBuffer()]:[2];case 1:return a.sent(),[2];}})})},t.prototype.run=function(){return o(this,void 0,void 0,function(){var e,t,a,n,o,s,i,d,c,u;return l(this,function(l){switch(l.label){case 0:if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('placeholderContext is not initialized');if(!this.variableMap)throw new Error('Variable map is not initialized');if(!this.staticBuffer)throw new Error('StaticBuffer map is not initialized');if(!this.dynamicBuffer)throw new Error('DynamicBuffer map is not initialized');e=this.variableMap,t=this.placeholderContext,a=this.descriptor.exec_infos.map(function(e){return t.resolve(e)}),n=Date.now(),o=Date.now(),s=0,l.label=1;case 1:return s<a.length?(i=Date.now(),!(1e3<=i-o))?[3,3]:(console.log('Processed '+s+'/'+a.length+' kernels in '+(i-n)+' ms'),o=i,[4,r()]):[3,5];case 2:l.sent(),l.label=3;case 3:d=a[s],c=d.inputs.map(function(t){return e.get(t)}),u=d.outputs.map(function(t){return e.get(t)}),this.kernelObj[d.entry_func_name](c,u,d.call_option),l.label=4;case 4:return s++,[3,1];case 5:return console.log('Processed '+a.length+'/'+a.length+' kernels in '+(Date.now()-n)+' ms'),[2];}})})},t.prototype.getInputViews=function(){if(this.inputs)return this.inputs;if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');var e=this.descriptor,t=this.placeholderContext;return this.inputs=e.inputs.map(function(a){var r=e.memory_layout.static.allocations[a]||e.memory_layout.dynamic.allocations[a],n=new u.default(null,r.offset*u.default.BYTES_PER_ELEMENT,r.size,t);return n}),this.inputs},t.prototype.getOutputViews=function(){if(this.outputs)return this.outputs;if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');var e=this.descriptor,t=this.placeholderContext;return this.outputs=e.outputs.map(function(a){var r=e.memory_layout.static.allocations[a]||e.memory_layout.dynamic.allocations[a],n=new u.default(null,r.offset*u.default.BYTES_PER_ELEMENT,r.size,t);return n}),this.outputs},t)}(p.DescriptorRunner);t.default=h},function(e){var t=function(){return this}();try{t=t||Function('return this')()||(1,eval)('this')}catch(a){'object'==typeof window&&(t=window)}e.exports=t},function(e,t,a){'use strict';var r=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var o=a(24),l=function(){function e(){}return e.prototype.decode=function(t){return r(this,void 0,void 0,function(){var a,r,l,d,c,u,p,h,f,i,_,g,m,b,s,y,f;return n(this,function(){for(a=[],r=0,l=new DataView(t.buffer,t.byteOffset),d=0;d<t.length;){for(c=l.getInt32(d,!0),d+=4,u=l.getInt32(d,!0),d+=4,p=l.getFloat32(d,!0),d+=8,h=new Float32Array(256),f=0;256>f;f++)h[f]=e.decode_table[127&f]*p*(128>f?1:-1);for(i=new Uint8Array(t.buffer,t.byteOffset+d,u),_=o.inflate(i),g=_.length,m=new Float32Array(g),b=0;b<g;b++)m[b]=h[_[b]];a.push(m),r+=g,d+=u}for(s=new Float32Array(r),y=0,f=0;f<a.length;f++)s.set(a[f],y),y+=a[f].length;return[2,s]})})},e.decode_table=[0,0.000002750000021,0.000007249999726,0.00001875000089,0.00003624999954,0.00005874999624,0.00008624999464,0.0001437500032,0.0002312500001,0.0003187500115,0.0004062500084,0.0005187499919,0.0006562499912,0.0007937499322,0.0009312499315,0.001218750025,0.00165624998,0.002093750052,0.002531250007,0.002968749963,0.003406249918,0.003843750106,0.004281249829,0.004843750037,0.005531250034,0.006218749564,0.00690624956,0.007593749557,0.008281249553,0.008968749084,0.009656248614,0.01109374966,0.01328125037,0.01546875015,0.01765624993,0.0198437497,0.02203124948,0.02421874925,0.02640625089,0.02859375067,0.03078125045,0.03296874836,0.03515625,0.03734375164,0.03953124955,0.04171875119,0.04390624911,0.04671875015,0.0501562506,0.05359374732,0.05703124776,0.06046874821,0.06390624493,0.06734374911,0.07078124583,0.07421874255,0.07765624672,0.08109374344,0.08453124017,0.08796874434,0.09140624106,0.09484373778,0.09828124195,0.10546875,0.116406247,0.127343744,0.138281256,0.149218753,0.16015625,0.171093747,0.182031244,0.192968756,0.203906253,0.21484375,0.225781247,0.236718744,0.247656256,0.2585937381,0.26953125,0.2804687619,0.291406244,0.302343756,0.3132812381,0.32421875,0.3351562619,0.346093744,0.357031256,0.3679687381,0.37890625,0.3898437619,0.400781244,0.411718756,0.4226562381,0.43359375,0.4445312619,0.458593756,0.4757812321,0.4929687381,0.5101562142,0.52734375,0.5445312262,0.5617187023,0.5789062381,0.5960937142,0.61328125,0.6304687262,0.6476562023,0.6648437381,0.6820312142,0.6992186904,0.7164062262,0.7335937023,0.7507811785,0.7679687142,0.7851561904,0.8023436666,0.8195312023,0.8367186785,0.8539061546,0.8710936904,0.8882811666,0.9054686427,0.9226561785,0.9398436546,0.9570311308,0.9742186666,0.9914061427,1],e}();t.default=l},function(e,t,a){'use strict';var r=a(0).assign,n=a(25),o=a(28),l=a(13),i={};r(i,n,o,l),e.exports=i},function(e,t,a){'use strict';function r(e){if(!(this instanceof r))return new r(e);this.options=l.assign({level:_,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:''},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&16>t.windowBits&&(t.windowBits+=16),this.err=0,this.msg='',this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var a=o.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(a!==p)throw new Error(s[a]);if(t.header&&o.deflateSetHeader(this.strm,t.header),t.dictionary){var n;if(n='string'==typeof t.dictionary?i.string2buf(t.dictionary):'[object ArrayBuffer]'===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,a=o.deflateSetDictionary(this.strm,n),a!==p)throw new Error(s[a]);this._dict_set=!0}}function n(e,t){var a=new r(t);if(a.push(e,!0),a.err)throw a.msg||s[a.err];return a.result}var o=a(26),l=a(0),i=a(11),s=a(8),d=a(12),c=Object.prototype.toString,u=4,p=0,h=1,f=2,_=-1,g=0,m=8;r.prototype.push=function(e,t){var a=this.strm,r=this.options.chunkSize,n,s;if(this.ended)return!1;s=t===~~t?t:!0===t?u:0,a.input='string'==typeof e?i.string2buf(e):'[object ArrayBuffer]'===c.call(e)?new Uint8Array(e):e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new l.Buf8(r),a.next_out=0,a.avail_out=r),n=o.deflate(a,s),n!==h&&n!==p)return this.onEnd(n),this.ended=!0,!1;(0===a.avail_out||0===a.avail_in&&(s===u||s===f))&&('string'===this.options.to?this.onData(i.buf2binstring(l.shrinkBuf(a.output,a.next_out))):this.onData(l.shrinkBuf(a.output,a.next_out)))}while((0<a.avail_in||0===a.avail_out)&&n!==h);return s===u?(n=o.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===p):s!==f||(this.onEnd(p),a.avail_out=0,!0)},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){e===p&&('string'===this.options.to?this.result=this.chunks.join(''):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=r,t.deflate=n,t.deflateRaw=function(e,t){return t=t||{},t.raw=!0,n(e,t)},t.gzip=function(e,t){return t=t||{},t.gzip=!0,n(e,t)}},function(e,t,a){'use strict';function r(e,t){return e.msg=T[t],t}function n(e){return(e<<1)-(4<e?9:0)}function o(e){for(var t=e.length;0<=--t;)e[t]=0}function l(e){var t=e.state,a=t.pending;a>e.avail_out&&(a=e.avail_out);0===a||(E.arraySet(e.output,t.pending_buf,t.pending_out,a,e.next_out),e.next_out+=a,t.pending_out+=a,e.total_out+=a,e.avail_out-=a,t.pending-=a,0===t.pending&&(t.pending_out=0))}function i(e,t){k._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,l(e.strm)}function d(e,t){e.pending_buf[e.pending++]=t}function c(e,t){e.pending_buf[e.pending++]=255&t>>>8,e.pending_buf[e.pending++]=255&t}function u(e,t,a,r){var n=e.avail_in;return(n>r&&(n=r),0===n)?0:(e.avail_in-=n,E.arraySet(t,e.input,e.next_in,n,a),1===e.state.wrap?e.adler=I(e.adler,t,n,a):2===e.state.wrap&&(e.adler=C(e.adler,t,n,a)),e.next_in+=n,e.total_in+=n,n)}function p(e,t){var a=e.max_chain_length,r=e.strstart,n=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-K?e.strstart-(e.w_size-K):0,i=e.window,s=e.w_mask,d=e.prev,c=e.strstart+Z,u=i[r+n-1],p=i[r+n],h,f;e.prev_length>=e.good_match&&(a>>=2),o>e.lookahead&&(o=e.lookahead);do{if(h=t,i[h+n]!==p||i[h+n-1]!==u||i[h]!==i[r]||i[++h]!==i[r+1])continue;r+=2,h++;do;while(i[++r]===i[++h]&&i[++r]===i[++h]&&i[++r]===i[++h]&&i[++r]===i[++h]&&i[++r]===i[++h]&&i[++r]===i[++h]&&i[++r]===i[++h]&&i[++r]===i[++h]&&r<c);if(f=Z-(c-r),r=c-Z,f>n){if(e.match_start=t,n=f,f>=o)break;u=i[r+n-1],p=i[r+n]}}while((t=d[t&s])>l&&0!=--a);return n<=e.lookahead?n:e.lookahead}function h(e){var t=e.w_size,a,r,n,o,l;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-K)){E.arraySet(e.window,e.window,t,t,0),e.match_start-=t,e.strstart-=t,e.block_start-=t,r=e.hash_size,a=r;do n=e.head[--a],e.head[a]=n>=t?n-t:0;while(--r);r=t,a=r;do n=e.prev[--a],e.prev[a]=n>=t?n-t:0;while(--r);o+=t}if(0===e.strm.avail_in)break;if(r=u(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=r,e.lookahead+e.insert>=Y)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+Y-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<Y)););}while(e.lookahead<K&&0!==e.strm.avail_in)}function s(e,t){for(var a,r;;){if(e.lookahead<K){if(h(e),e.lookahead<K&&t===S)return re;if(0===e.lookahead)break}if(a=0,e.lookahead>=Y&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Y-1])&e.hash_mask,a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==a&&e.strstart-a<=e.w_size-K&&(e.match_length=p(e,a)),!(e.match_length>=Y))r=k._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;else if(r=k._tr_tally(e,e.strstart-e.match_start,e.match_length-Y),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Y){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Y-1])&e.hash_mask,a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;if(r&&(i(e,!1),0===e.strm.avail_out))return re}return e.insert=e.strstart<Y-1?e.strstart:Y-1,t===R?(i(e,!0),0===e.strm.avail_out?oe:le):e.last_lit&&(i(e,!1),0===e.strm.avail_out)?re:ne}function f(e,t){for(var a,r,n;;){if(e.lookahead<K){if(h(e),e.lookahead<K&&t===S)return re;if(0===e.lookahead)break}if(a=0,e.lookahead>=Y&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Y-1])&e.hash_mask,a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Y-1,0!==a&&e.prev_length<e.max_lazy_match&&e.strstart-a<=e.w_size-K&&(e.match_length=p(e,a),5>=e.match_length&&(e.strategy===O||e.match_length===Y&&4096<e.strstart-e.match_start)&&(e.match_length=Y-1)),e.prev_length>=Y&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-Y,r=k._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-Y),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+Y-1])&e.hash_mask,a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length);if(e.match_available=0,e.match_length=Y-1,e.strstart++,r&&(i(e,!1),0===e.strm.avail_out))return re}else if(!e.match_available)e.match_available=1,e.strstart++,e.lookahead--;else if(r=k._tr_tally(e,0,e.window[e.strstart-1]),r&&i(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return re}return e.match_available&&(r=k._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Y-1?e.strstart:Y-1,t===R?(i(e,!0),0===e.strm.avail_out?oe:le):e.last_lit&&(i(e,!1),0===e.strm.avail_out)?re:ne}function _(e,t){for(var a=e.window,r,n,o,l;;){if(e.lookahead<=Z){if(h(e),e.lookahead<=Z&&t===S)return re;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=Y&&0<e.strstart&&(o=e.strstart-1,n=a[o],n===a[++o]&&n===a[++o]&&n===a[++o])){l=e.strstart+Z;do;while(n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&o<l);e.match_length=Z-(l-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Y?(r=k._tr_tally(e,1,e.match_length-Y),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=k._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(i(e,!1),0===e.strm.avail_out))return re}return e.insert=0,t===R?(i(e,!0),0===e.strm.avail_out?oe:le):e.last_lit&&(i(e,!1),0===e.strm.avail_out)?re:ne}function g(e,t){for(var a;;){if(0===e.lookahead&&(h(e),0===e.lookahead)){if(t===S)return re;break}if(e.match_length=0,a=k._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,a&&(i(e,!1),0===e.strm.avail_out))return re}return e.insert=0,t===R?(i(e,!0),0===e.strm.avail_out?oe:le):e.last_lit&&(i(e,!1),0===e.strm.avail_out)?re:ne}function m(e,t,a,r,n){this.good_length=e,this.max_lazy=t,this.nice_length=a,this.max_chain=r,this.func=n}function b(e){e.window_size=2*e.w_size,o(e.head),e.max_lazy_match=ie[e.level].max_lazy,e.good_match=ie[e.level].good_length,e.nice_match=ie[e.level].nice_length,e.max_chain_length=ie[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Y-1,e.match_available=0,e.ins_h=0}function y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=U,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new E.Buf16(2*V),this.dyn_dtree=new E.Buf16(2*(2*H+1)),this.bl_tree=new E.Buf16(2*(2*G+1)),o(this.dyn_ltree),o(this.dyn_dtree),o(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new E.Buf16(X+1),this.heap=new E.Buf16(2*j+1),o(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new E.Buf16(2*j+1),o(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function v(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=F,t=e.state,t.pending=0,t.pending_out=0,0>t.wrap&&(t.wrap=-t.wrap),t.status=t.wrap?q:te,e.adler=2===t.wrap?0:1,t.last_flush=S,k._tr_init(t),B):r(e,A)}function w(e){var t=v(e);return t===B&&b(e.state),t}function x(e,t,a,n,o,l){if(!e)return A;var i=1;if(t===N&&(t=6),0>n?(i=0,n=-n):15<n&&(i=2,n-=16),1>o||o>W||a!==U||8>n||15<n||0>t||9<t||0>l||l>M)return r(e,A);8===n&&(n=9);var d=new y;return e.state=d,d.strm=e,d.wrap=i,d.gzhead=null,d.w_bits=n,d.w_size=1<<d.w_bits,d.w_mask=d.w_size-1,d.hash_bits=o+7,d.hash_size=1<<d.hash_bits,d.hash_mask=d.hash_size-1,d.hash_shift=~~((d.hash_bits+Y-1)/Y),d.window=new E.Buf8(2*d.w_size),d.head=new E.Buf16(d.hash_size),d.prev=new E.Buf16(d.w_size),d.lit_bufsize=1<<o+6,d.pending_buf_size=4*d.lit_bufsize,d.pending_buf=new E.Buf8(d.pending_buf_size),d.d_buf=1*d.lit_bufsize,d.l_buf=3*d.lit_bufsize,d.level=t,d.strategy=l,d.method=a,w(e)}var E=a(0),k=a(27),I=a(9),C=a(10),T=a(8),S=0,R=4,D=5,B=0,P=1,A=-2,z=-5,N=-1,O=1,L=2,M=4,F=2,U=8,W=9,j=256+1+29,H=30,G=19,V=2*j+1,X=15,Y=3,Z=258,K=Z+Y+1,q=42,Q=69,J=73,$=91,ee=103,te=113,ae=666,re=1,ne=2,oe=3,le=4,ie;ie=[new m(0,0,0,0,function(e,t){var a=65535;for(a>e.pending_buf_size-5&&(a=e.pending_buf_size-5);;){if(1>=e.lookahead){if(h(e),0===e.lookahead&&t===S)return re;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+a;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,i(e,!1),0===e.strm.avail_out))return re;if(e.strstart-e.block_start>=e.w_size-K&&(i(e,!1),0===e.strm.avail_out))return re}return e.insert=0,t===R?(i(e,!0),0===e.strm.avail_out?oe:le):e.strstart>e.block_start&&(i(e,!1),0===e.strm.avail_out)?re:re}),new m(4,4,8,4,s),new m(4,5,16,8,s),new m(4,6,32,32,s),new m(4,4,16,16,f),new m(8,16,32,32,f),new m(8,16,128,128,f),new m(8,32,128,256,f),new m(32,128,258,1024,f),new m(32,258,258,4096,f)],t.deflateInit=function(e,t){return x(e,t,U,15,8,0)},t.deflateInit2=x,t.deflateReset=w,t.deflateResetKeep=v,t.deflateSetHeader=function(e,t){return e&&e.state?2===e.state.wrap?(e.state.gzhead=t,B):A:A},t.deflate=function(e,t){var a,i,s,u;if(!e||!e.state||t>D||0>t)return e?r(e,A):A;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||i.status===ae&&t!==R)return r(e,0===e.avail_out?z:A);if(i.strm=e,a=i.last_flush,i.last_flush=t,i.status===q)if(2===i.wrap)e.adler=0,d(i,31),d(i,139),d(i,8),i.gzhead?(d(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),d(i,255&i.gzhead.time),d(i,255&i.gzhead.time>>8),d(i,255&i.gzhead.time>>16),d(i,255&i.gzhead.time>>24),d(i,9===i.level?2:i.strategy>=L||2>i.level?4:0),d(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(d(i,255&i.gzhead.extra.length),d(i,255&i.gzhead.extra.length>>8)),i.gzhead.hcrc&&(e.adler=C(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=Q):(d(i,0),d(i,0),d(i,0),d(i,0),d(i,0),d(i,9===i.level?2:i.strategy>=L||2>i.level?4:0),d(i,3),i.status=te);else{var p=U+(i.w_bits-8<<4)<<8,h=-1;h=i.strategy>=L||2>i.level?0:6>i.level?1:6===i.level?2:3,p|=h<<6,0!==i.strstart&&(p|=32),p+=31-p%31,i.status=te,c(i,p),0!==i.strstart&&(c(i,e.adler>>>16),c(i,65535&e.adler)),e.adler=1}if(i.status===Q)if(i.gzhead.extra){for(s=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=C(e.adler,i.pending_buf,i.pending-s,s)),l(e),s=i.pending,i.pending===i.pending_buf_size));)d(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>s&&(e.adler=C(e.adler,i.pending_buf,i.pending-s,s)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=J)}else i.status=J;if(i.status===J)if(i.gzhead.name){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=C(e.adler,i.pending_buf,i.pending-s,s)),l(e),s=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,d(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>s&&(e.adler=C(e.adler,i.pending_buf,i.pending-s,s)),0===u&&(i.gzindex=0,i.status=$)}else i.status=$;if(i.status===$)if(i.gzhead.comment){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=C(e.adler,i.pending_buf,i.pending-s,s)),l(e),s=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,d(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>s&&(e.adler=C(e.adler,i.pending_buf,i.pending-s,s)),0===u&&(i.status=ee)}else i.status=ee;if(i.status===ee&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&l(e),i.pending+2<=i.pending_buf_size&&(d(i,255&e.adler),d(i,255&e.adler>>8),e.adler=0,i.status=te)):i.status=te),0!==i.pending){if(l(e),0===e.avail_out)return i.last_flush=-1,B;}else if(0===e.avail_in&&n(t)<=n(a)&&t!==R)return r(e,z);if(i.status===ae&&0!==e.avail_in)return r(e,z);if(0!==e.avail_in||0!==i.lookahead||t!==S&&i.status!==ae){var f=i.strategy===L?g(i,t):i.strategy===3?_(i,t):ie[i.level].func(i,t);if((f===oe||f===le)&&(i.status=ae),f===re||f===oe)return 0===e.avail_out&&(i.last_flush=-1),B;if(f===ne&&(t===1?k._tr_align(i):t!==D&&(k._tr_stored_block(i,0,0,!1),t===3&&(o(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),l(e),0===e.avail_out))return i.last_flush=-1,B}return t===R?0>=i.wrap?P:(2===i.wrap?(d(i,255&e.adler),d(i,255&e.adler>>8),d(i,255&e.adler>>16),d(i,255&e.adler>>24),d(i,255&e.total_in),d(i,255&e.total_in>>8),d(i,255&e.total_in>>16),d(i,255&e.total_in>>24)):(c(i,e.adler>>>16),c(i,65535&e.adler)),l(e),0<i.wrap&&(i.wrap=-i.wrap),0===i.pending?P:B):B},t.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status,t!==q&&t!==Q&&t!==J&&t!==$&&t!==ee&&t!==te&&t!==ae)?r(e,A):(e.state=null,t===te?r(e,-3):B):A},t.deflateSetDictionary=function(e,t){var a=t.length,r,l,i,n,s,d,c,u;if(!e||!e.state)return A;if(r=e.state,n=r.wrap,2===n||1===n&&r.status!==q||r.lookahead)return A;for(1===n&&(e.adler=I(e.adler,t,a,0)),r.wrap=0,a>=r.w_size&&(0===n&&(o(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new E.Buf8(r.w_size),E.arraySet(u,t,a-r.w_size,r.w_size,0),t=u,a=r.w_size),s=e.avail_in,d=e.next_in,c=e.input,e.avail_in=a,e.next_in=0,e.input=t,h(r);r.lookahead>=Y;){l=r.strstart,i=r.lookahead-(Y-1);do r.ins_h=(r.ins_h<<r.hash_shift^r.window[l+Y-1])&r.hash_mask,r.prev[l&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=l,l++;while(--i);r.strstart=l,r.lookahead=Y-1,h(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=Y-1,r.match_available=0,e.next_in=d,e.input=c,e.avail_in=s,r.wrap=n,B},t.deflateInfo='pako deflate (from Nodeca project)'},function(e,t,a){'use strict';function r(e){for(var t=e.length;0<=--t;)e[t]=0}function o(e,t,a,r,n){this.static_tree=e,this.extra_bits=t,this.extra_base=a,this.elems=r,this.max_length=n,this.has_stree=e&&e.length}function n(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function l(e){return 256>e?J[e]:J[256+(e>>>7)]}function i(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=255&t>>>8}function d(e,t,a){e.bi_valid>U-a?(e.bi_buf|=65535&t<<e.bi_valid,i(e,e.bi_buf),e.bi_buf=t>>U-e.bi_valid,e.bi_valid+=a-U):(e.bi_buf|=65535&t<<e.bi_valid,e.bi_valid+=a)}function c(e,t,a){d(e,a[2*t],a[2*t+1])}function s(e,t){var a=0;do a|=1&e,e>>>=1,a<<=1;while(0<--t);return a>>>1}function u(e){16===e.bi_valid?(i(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function p(e,t){var a=t.dyn_tree,r=t.max_code,o=t.stat_desc.static_tree,l=t.stat_desc.has_stree,i=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,d=t.stat_desc.max_length,c=0,u,p,n,h,_,g;for(h=0;h<=F;h++)e.bl_count[h]=0;for(a[2*e.heap[e.heap_max]+1]=0,u=e.heap_max+1;u<M;u++)(p=e.heap[u],h=a[2*a[2*p+1]+1]+1,h>d&&(h=d,c++),a[2*p+1]=h,!(p>r))&&(e.bl_count[h]++,_=0,p>=s&&(_=i[p-s]),g=a[2*p],e.opt_len+=g*(h+_),l&&(e.static_len+=g*(o[2*p+1]+_)));if(0!=c){do{for(h=d-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[d]--,c-=2}while(0<c);for(h=d;0!==h;h--)for(p=e.bl_count[h];0!==p;)(n=e.heap[--u],!(n>r))&&(a[2*n+1]!==h&&(e.opt_len+=(h-a[2*n+1])*a[2*n],a[2*n+1]=h),p--)}}function h(e,t,a){var r=Array(F+1),o=0,l,i;for(l=1;l<=F;l++)r[l]=o=o+a[l-1]<<1;for(i=0;i<=t;i++){var n=e[2*i+1];0!==n&&(e[2*i]=s(r[n]++,n))}}function f(){var e=Array(F+1),t,a,r,n,l;for(r=0,n=0;n<A-1;n++)for(ee[n]=r,t=0;t<1<<X[n];t++)$[r++]=n;for($[r-1]=n,l=0,n=0;16>n;n++)for(te[n]=l,t=0;t<1<<Y[n];t++)J[l++]=n;for(l>>=7;n<O;n++)for(te[n]=l<<7,t=0;t<1<<Y[n]-7;t++)J[256+l++]=n;for(a=0;a<=F;a++)e[a]=0;for(t=0;143>=t;)q[2*t+1]=8,t++,e[8]++;for(;255>=t;)q[2*t+1]=9,t++,e[9]++;for(;279>=t;)q[2*t+1]=7,t++,e[7]++;for(;287>=t;)q[2*t+1]=8,t++,e[8]++;for(h(q,N+1,e),t=0;t<O;t++)Q[2*t+1]=5,Q[2*t]=s(t,5);re=new o(q,X,z+1,N,F),ne=new o(Q,Y,0,O,F),oe=new o([],Z,0,L,W)}function _(e){var t;for(t=0;t<N;t++)e.dyn_ltree[2*t]=0;for(t=0;t<O;t++)e.dyn_dtree[2*t]=0;for(t=0;t<L;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*j]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function g(e){8<e.bi_valid?i(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function m(e,t,a,r){g(e),r&&(i(e,a),i(e,~a)),S.arraySet(e.pending_buf,e.window,t,a,e.pending),e.pending+=a}function b(e,t,a,r){var n=2*t,o=2*a;return e[n]<e[o]||e[n]===e[o]&&r[t]<=r[a]}function y(e,t,a){for(var r=e.heap[a],n=a<<1;n<=e.heap_len&&(n<e.heap_len&&b(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!b(t,r,e.heap[n],e.depth));)e.heap[a]=e.heap[n],a=n,n<<=1;e.heap[a]=r}function v(e,t,a){var r=0,n,o,i,s;if(0!==e.last_lit)do n=e.pending_buf[e.d_buf+2*r]<<8|e.pending_buf[e.d_buf+2*r+1],o=e.pending_buf[e.l_buf+r],r++,0===n?c(e,o,t):(i=$[o],c(e,i+z+1,t),s=X[i],0!==s&&(o-=ee[i],d(e,o,s)),n--,i=l(n),c(e,i,a),s=Y[i],0!==s&&(n-=te[i],d(e,n,s)));while(r<e.last_lit);c(e,j,t)}function w(e,t){var a=t.dyn_tree,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,i=-1,s,n,d;for(e.heap_len=0,e.heap_max=M,s=0;s<l;s++)0===a[2*s]?a[2*s+1]=0:(e.heap[++e.heap_len]=i=s,e.depth[s]=0);for(;2>e.heap_len;)d=e.heap[++e.heap_len]=2>i?++i:0,a[2*d]=1,e.depth[d]=0,e.opt_len--,o&&(e.static_len-=r[2*d+1]);for(t.max_code=i,s=e.heap_len>>1;1<=s;s--)y(e,a,s);d=l;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],y(e,a,1),n=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=n,a[2*d]=a[2*s]+a[2*n],e.depth[d]=(e.depth[s]>=e.depth[n]?e.depth[s]:e.depth[n])+1,a[2*s+1]=a[2*n+1]=d,e.heap[1]=d++,y(e,a,1);while(2<=e.heap_len);e.heap[--e.heap_max]=e.heap[1],p(e,t),h(a,i,e.bl_count)}function x(e,t,a){var r=-1,o=t[1],l=0,i=7,s=4,d,n;for(0===o&&(i=138,s=3),t[2*(a+1)+1]=65535,d=0;d<=a;d++){if(n=o,o=t[2*(d+1)+1],++l<i&&n===o)continue;else l<s?e.bl_tree[2*n]+=l:0===n?10>=l?e.bl_tree[2*G]++:e.bl_tree[2*V]++:(n!==r&&e.bl_tree[2*n]++,e.bl_tree[2*H]++);l=0,r=n,0===o?(i=138,s=3):n===o?(i=6,s=3):(i=7,s=4)}}function E(e,t,a){var r=-1,o=t[1],l=0,i=7,s=4,u,n;for(0===o&&(i=138,s=3),u=0;u<=a;u++){if(n=o,o=t[2*(u+1)+1],++l<i&&n===o)continue;else if(l<s)do c(e,n,e.bl_tree);while(0!=--l);else 0===n?10>=l?(c(e,G,e.bl_tree),d(e,l-3,3)):(c(e,V,e.bl_tree),d(e,l-11,7)):(n!==r&&(c(e,n,e.bl_tree),l--),c(e,H,e.bl_tree),d(e,l-3,2));l=0,r=n,0===o?(i=138,s=3):n===o?(i=6,s=3):(i=7,s=4)}}function k(e){var t;for(x(e,e.dyn_ltree,e.l_desc.max_code),x(e,e.dyn_dtree,e.d_desc.max_code),w(e,e.bl_desc),t=L-1;3<=t&&0===e.bl_tree[2*K[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function I(e,t,a,r){var n;for(d(e,t-257,5),d(e,a-1,5),d(e,r-4,4),n=0;n<r;n++)d(e,e.bl_tree[2*K[n]+1],3);E(e,e.dyn_ltree,t-1),E(e,e.dyn_dtree,a-1)}function C(e){var t=4093624447,a;for(a=0;31>=a;a++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*a])return R;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return D;for(a=32;a<z;a++)if(0!==e.dyn_ltree[2*a])return D;return R}function T(e,t,a,r){d(e,(B<<1)+(r?1:0),3),m(e,t,a,!0)}var S=a(0),R=0,D=1,B=0,P=1,A=29,z=256,N=z+1+A,O=30,L=19,M=2*N+1,F=15,U=16,W=7,j=256,H=16,G=17,V=18,X=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=Array(2*(N+2));r(q);var Q=Array(2*O);r(Q);var J=Array(512);r(J);var $=Array(258-3+1);r($);var ee=Array(A);r(ee);var te=Array(O);r(te);var ae=!1,re,ne,oe;t._tr_init=function(e){ae||(f(),ae=!0),e.l_desc=new n(e.dyn_ltree,re),e.d_desc=new n(e.dyn_dtree,ne),e.bl_desc=new n(e.bl_tree,oe),e.bi_buf=0,e.bi_valid=0,_(e)},t._tr_stored_block=T,t._tr_flush_block=function(e,t,a,r){var n=0,o,l;0<e.level?(e.strm.data_type===2&&(e.strm.data_type=C(e)),w(e,e.l_desc),w(e,e.d_desc),n=k(e),o=e.opt_len+3+7>>>3,l=e.static_len+3+7>>>3,l<=o&&(o=l)):o=l=a+5,a+4<=o&&-1!==t?T(e,t,a,r):e.strategy===4||l===o?(d(e,(P<<1)+(r?1:0),3),v(e,q,Q)):(d(e,(2<<1)+(r?1:0),3),I(e,e.l_desc.max_code+1,e.d_desc.max_code+1,n+1),v(e,e.dyn_ltree,e.dyn_dtree)),_(e),r&&g(e)},t._tr_tally=function(e,t,a){return e.pending_buf[e.d_buf+2*e.last_lit]=255&t>>>8,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&a,e.last_lit++,0===t?e.dyn_ltree[2*a]++:(e.matches++,t--,e.dyn_ltree[2*($[a]+z+1)]++,e.dyn_dtree[2*l(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){d(e,P<<1,3),c(e,j,q),u(e)}},function(e,t,a){'use strict';function r(e){if(!(this instanceof r))return new r(e);this.options=l.assign({chunkSize:16384,windowBits:0,to:''},e||{});var t=this.options;t.raw&&0<=t.windowBits&&16>t.windowBits&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),0<=t.windowBits&&16>t.windowBits&&!(e&&e.windowBits)&&(t.windowBits+=32),15<t.windowBits&&48>t.windowBits&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg='',this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var a=o.inflateInit2(this.strm,t.windowBits);if(a!==s.Z_OK)throw new Error(d[a]);this.header=new u,o.inflateGetHeader(this.strm,this.header)}function n(e,t){var a=new r(t);if(a.push(e,!0),a.err)throw a.msg||d[a.err];return a.result}var o=a(29),l=a(0),i=a(11),s=a(13),d=a(8),c=a(12),u=a(32),p=Object.prototype.toString;r.prototype.push=function(e,t){var a=this.strm,r=this.options.chunkSize,n=this.options.dictionary,d=!1,c,u,h,f,_,g;if(this.ended)return!1;u=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,a.input='string'==typeof e?i.binstring2buf(e):'[object ArrayBuffer]'===p.call(e)?new Uint8Array(e):e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new l.Buf8(r),a.next_out=0,a.avail_out=r),c=o.inflate(a,s.Z_NO_FLUSH),c===s.Z_NEED_DICT&&n&&(g='string'==typeof n?i.string2buf(n):'[object ArrayBuffer]'===p.call(n)?new Uint8Array(n):n,c=o.inflateSetDictionary(this.strm,g)),c===s.Z_BUF_ERROR&&!0==d&&(c=s.Z_OK,d=!1),c!==s.Z_STREAM_END&&c!==s.Z_OK)return this.onEnd(c),this.ended=!0,!1;a.next_out&&(0===a.avail_out||c===s.Z_STREAM_END||0===a.avail_in&&(u===s.Z_FINISH||u===s.Z_SYNC_FLUSH))&&('string'===this.options.to?(h=i.utf8border(a.output,a.next_out),f=a.next_out-h,_=i.buf2string(a.output,h),a.next_out=f,a.avail_out=r-f,f&&l.arraySet(a.output,a.output,h,f,0),this.onData(_)):this.onData(l.shrinkBuf(a.output,a.next_out))),0===a.avail_in&&0===a.avail_out&&(d=!0)}while((0<a.avail_in||0===a.avail_out)&&c!==s.Z_STREAM_END);return c===s.Z_STREAM_END&&(u=s.Z_FINISH),u===s.Z_FINISH?(c=o.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===s.Z_OK):u!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),a.avail_out=0,!0)},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){e===s.Z_OK&&('string'===this.options.to?this.result=this.chunks.join(''):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=r,t.inflate=n,t.inflateRaw=function(e,t){return t=t||{},t.raw=!0,n(e,t)},t.ungzip=n},function(t,a,r){'use strict';function o(e){return(255&e>>>24)+(65280&e>>>8)+((65280&e)<<8)+((255&e)<<24)}function n(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new p.Buf16(320),this.work=new p.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function l(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg='',t.wrap&&(e.adler=1&t.wrap),t.mode=C,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new p.Buf32(re),t.distcode=t.distdyn=new p.Buf32(ne),t.sane=1,t.back=-1,w):x}function i(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,l(e)):x}function s(e,t){var a,r;return e&&e.state?(r=e.state,0>t?(a=0,t=-t):(a=(t>>4)+1,48>t&&(t&=15)),t&&(8>t||15<t))?x:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=a,r.wbits=t,i(e)):x}function d(e,t){var a,r;return e?(r=new n,e.state=r,r.window=null,a=s(e,t),a!==w&&(e.state=null),a):x}function c(e){if(oe){var t;for(le=new p.Buf32(512),ie=new p.Buf32(32),t=0;144>t;)e.lens[t++]=8;for(;256>t;)e.lens[t++]=9;for(;280>t;)e.lens[t++]=7;for(;288>t;)e.lens[t++]=8;for(g(m,e.lens,0,288,le,0,e.work,{bits:9}),t=0;32>t;)e.lens[t++]=5;g(b,e.lens,0,32,ie,0,e.work,{bits:5}),oe=!1}e.lencode=le,e.lenbits=9,e.distcode=ie,e.distbits=5}function u(e,t,a,r){var n=e.state,o;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new p.Buf8(n.wsize)),r>=n.wsize?(p.arraySet(n.window,t,a-n.wsize,n.wsize,0),n.wnext=0,n.whave=n.wsize):(o=n.wsize-n.wnext,o>r&&(o=r),p.arraySet(n.window,t,a-r,o,n.wnext),r-=o,r?(p.arraySet(n.window,t,a-r,r,0),n.wnext=r,n.whave=n.wsize):(n.wnext+=o,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=o))),0}var p=r(0),h=r(9),f=r(10),_=r(30),g=r(31),m=1,b=2,y=4,v=6,w=0,x=-2,E=-3,k=-4,I=8,C=1,T=2,S=3,R=4,D=5,B=6,P=7,A=8,z=9,N=10,O=11,L=12,M=13,F=14,U=15,W=16,j=17,H=18,G=19,V=20,X=21,Y=22,Z=23,K=24,q=25,Q=26,J=27,$=28,ee=29,te=30,ae=31,re=852,ne=592,oe=!0,le,ie;a.inflateReset=i,a.inflateReset2=s,a.inflateResetKeep=l,a.inflateInit=function(e){return d(e,15)},a.inflateInit2=d,a.inflate=function(t,a){var r=0,l=new p.Buf8(4),i=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],s,d,re,ne,oe,le,ie,se,de,ce,ue,pe,he,fe,_e,ge,me,be,ye,ve,we,xe,Ee,ke;if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return x;s=t.state,s.mode===L&&(s.mode=M),oe=t.next_out,re=t.output,ie=t.avail_out,ne=t.next_in,d=t.input,le=t.avail_in,se=s.hold,de=s.bits,ce=le,ue=ie,xe=w;inf_leave:for(;;)switch(s.mode){case C:if(0===s.wrap){s.mode=M;break}for(;16>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}if(2&s.wrap&&35615===se){s.check=0,l[0]=255&se,l[1]=255&se>>>8,s.check=f(s.check,l,2,0),se=0,de=0,s.mode=T;break}if(s.flags=0,s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&se)<<8)+(se>>8))%31){t.msg='incorrect header check',s.mode=te;break}if((15&se)!=I){t.msg='unknown compression method',s.mode=te;break}if(se>>>=4,de-=4,we=(15&se)+8,0===s.wbits)s.wbits=we;else if(we>s.wbits){t.msg='invalid window size',s.mode=te;break}s.dmax=1<<we,t.adler=s.check=1,s.mode=512&se?N:L,se=0,de=0;break;case T:for(;16>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}if(s.flags=se,(255&s.flags)!=I){t.msg='unknown compression method',s.mode=te;break}if(57344&s.flags){t.msg='unknown header flags set',s.mode=te;break}s.head&&(s.head.text=1&se>>8),512&s.flags&&(l[0]=255&se,l[1]=255&se>>>8,s.check=f(s.check,l,2,0)),se=0,de=0,s.mode=S;case S:for(;32>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}s.head&&(s.head.time=se),512&s.flags&&(l[0]=255&se,l[1]=255&se>>>8,l[2]=255&se>>>16,l[3]=255&se>>>24,s.check=f(s.check,l,4,0)),se=0,de=0,s.mode=R;case R:for(;16>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}s.head&&(s.head.xflags=255&se,s.head.os=se>>8),512&s.flags&&(l[0]=255&se,l[1]=255&se>>>8,s.check=f(s.check,l,2,0)),se=0,de=0,s.mode=D;case D:if(1024&s.flags){for(;16>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}s.length=se,s.head&&(s.head.extra_len=se),512&s.flags&&(l[0]=255&se,l[1]=255&se>>>8,s.check=f(s.check,l,2,0)),se=0,de=0}else s.head&&(s.head.extra=null);s.mode=B;case B:if(1024&s.flags&&(pe=s.length,pe>le&&(pe=le),pe&&(s.head&&(we=s.head.extra_len-s.length,!s.head.extra&&(s.head.extra=Array(s.head.extra_len)),p.arraySet(s.head.extra,d,ne,pe,we)),512&s.flags&&(s.check=f(s.check,d,pe,ne)),le-=pe,ne+=pe,s.length-=pe),s.length))break inf_leave;s.length=0,s.mode=P;case P:if(2048&s.flags){if(0===le)break inf_leave;pe=0;do we=d[ne+pe++],s.head&&we&&65536>s.length&&(s.head.name+=e(we));while(we&&pe<le);if(512&s.flags&&(s.check=f(s.check,d,pe,ne)),le-=pe,ne+=pe,we)break inf_leave}else s.head&&(s.head.name=null);s.length=0,s.mode=A;case A:if(4096&s.flags){if(0===le)break inf_leave;pe=0;do we=d[ne+pe++],s.head&&we&&65536>s.length&&(s.head.comment+=e(we));while(we&&pe<le);if(512&s.flags&&(s.check=f(s.check,d,pe,ne)),le-=pe,ne+=pe,we)break inf_leave}else s.head&&(s.head.comment=null);s.mode=z;case z:if(512&s.flags){for(;16>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}if(se!==(65535&s.check)){t.msg='header crc mismatch',s.mode=te;break}se=0,de=0}s.head&&(s.head.hcrc=1&s.flags>>9,s.head.done=!0),t.adler=s.check=0,s.mode=L;break;case N:for(;32>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}t.adler=s.check=o(se),se=0,de=0,s.mode=O;case O:if(0===s.havedict)return t.next_out=oe,t.avail_out=ie,t.next_in=ne,t.avail_in=le,s.hold=se,s.bits=de,2;t.adler=s.check=1,s.mode=L;case L:if(a===5||a===v)break inf_leave;case M:if(s.last){se>>>=7&de,de-=7&de,s.mode=J;break}for(;3>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}switch(s.last=1&se,se>>>=1,de-=1,3&se){case 0:s.mode=F;break;case 1:if(c(s),s.mode=V,a===v){se>>>=2,de-=2;break inf_leave}break;case 2:s.mode=j;break;case 3:t.msg='invalid block type',s.mode=te;}se>>>=2,de-=2;break;case F:for(se>>>=7&de,de-=7&de;32>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}if((65535&se)!=(65535^se>>>16)){t.msg='invalid stored block lengths',s.mode=te;break}if(s.length=65535&se,se=0,de=0,s.mode=U,a===v)break inf_leave;case U:s.mode=W;case W:if(pe=s.length,pe){if(pe>le&&(pe=le),pe>ie&&(pe=ie),0===pe)break inf_leave;p.arraySet(re,d,ne,pe,oe),le-=pe,ne+=pe,ie-=pe,oe+=pe,s.length-=pe;break}s.mode=L;break;case j:for(;14>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}if(s.nlen=(31&se)+257,se>>>=5,de-=5,s.ndist=(31&se)+1,se>>>=5,de-=5,s.ncode=(15&se)+4,se>>>=4,de-=4,286<s.nlen||30<s.ndist){t.msg='too many length or distance symbols',s.mode=te;break}s.have=0,s.mode=H;case H:for(;s.have<s.ncode;){for(;3>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}s.lens[i[s.have++]]=7&se,se>>>=3,de-=3}for(;19>s.have;)s.lens[i[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,Ee={bits:s.lenbits},xe=g(0,s.lens,0,19,s.lencode,0,s.work,Ee),s.lenbits=Ee.bits,xe){t.msg='invalid code lengths set',s.mode=te;break}s.have=0,s.mode=G;case G:for(;s.have<s.nlen+s.ndist;){for(;;){if(r=s.lencode[se&(1<<s.lenbits)-1],_e=r>>>24,ge=255&r>>>16,me=65535&r,_e<=de)break;if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}if(16>me)se>>>=_e,de-=_e,s.lens[s.have++]=me;else{if(16===me){for(ke=_e+2;de<ke;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}if(se>>>=_e,de-=_e,0===s.have){t.msg='invalid bit length repeat',s.mode=te;break}we=s.lens[s.have-1],pe=3+(3&se),se>>>=2,de-=2}else if(17===me){for(ke=_e+3;de<ke;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}se>>>=_e,de-=_e,we=0,pe=3+(7&se),se>>>=3,de-=3}else{for(ke=_e+7;de<ke;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}se>>>=_e,de-=_e,we=0,pe=11+(127&se),se>>>=7,de-=7}if(s.have+pe>s.nlen+s.ndist){t.msg='invalid bit length repeat',s.mode=te;break}for(;pe--;)s.lens[s.have++]=we}}if(s.mode===te)break;if(0===s.lens[256]){t.msg='invalid code -- missing end-of-block',s.mode=te;break}if(s.lenbits=9,Ee={bits:s.lenbits},xe=g(m,s.lens,0,s.nlen,s.lencode,0,s.work,Ee),s.lenbits=Ee.bits,xe){t.msg='invalid literal/lengths set',s.mode=te;break}if(s.distbits=6,s.distcode=s.distdyn,Ee={bits:s.distbits},xe=g(b,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,Ee),s.distbits=Ee.bits,xe){t.msg='invalid distances set',s.mode=te;break}if(s.mode=V,a===v)break inf_leave;case V:s.mode=X;case X:if(6<=le&&258<=ie){t.next_out=oe,t.avail_out=ie,t.next_in=ne,t.avail_in=le,s.hold=se,s.bits=de,_(t,ue),oe=t.next_out,re=t.output,ie=t.avail_out,ne=t.next_in,d=t.input,le=t.avail_in,se=s.hold,de=s.bits,s.mode===L&&(s.back=-1);break}for(s.back=0;;){if(r=s.lencode[se&(1<<s.lenbits)-1],_e=r>>>24,ge=255&r>>>16,me=65535&r,_e<=de)break;if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}if(ge&&0==(240&ge)){for(be=_e,ye=ge,ve=me;;){if(r=s.lencode[ve+((se&(1<<be+ye)-1)>>be)],_e=r>>>24,ge=255&r>>>16,me=65535&r,be+_e<=de)break;if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}se>>>=be,de-=be,s.back+=be}if(se>>>=_e,de-=_e,s.back+=_e,s.length=me,0===ge){s.mode=Q;break}if(32&ge){s.back=-1,s.mode=L;break}if(64&ge){t.msg='invalid literal/length code',s.mode=te;break}s.extra=15&ge,s.mode=Y;case Y:if(s.extra){for(ke=s.extra;de<ke;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}s.length+=se&(1<<s.extra)-1,se>>>=s.extra,de-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=Z;case Z:for(;;){if(r=s.distcode[se&(1<<s.distbits)-1],_e=r>>>24,ge=255&r>>>16,me=65535&r,_e<=de)break;if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}if(0==(240&ge)){for(be=_e,ye=ge,ve=me;;){if(r=s.distcode[ve+((se&(1<<be+ye)-1)>>be)],_e=r>>>24,ge=255&r>>>16,me=65535&r,be+_e<=de)break;if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}se>>>=be,de-=be,s.back+=be}if(se>>>=_e,de-=_e,s.back+=_e,64&ge){t.msg='invalid distance code',s.mode=te;break}s.offset=me,s.extra=15&ge,s.mode=K;case K:if(s.extra){for(ke=s.extra;de<ke;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}s.offset+=se&(1<<s.extra)-1,se>>>=s.extra,de-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){t.msg='invalid distance too far back',s.mode=te;break}s.mode=q;case q:if(0===ie)break inf_leave;if(pe=ue-ie,s.offset>pe){if(pe=s.offset-pe,pe>s.whave&&s.sane){t.msg='invalid distance too far back',s.mode=te;break}pe>s.wnext?(pe-=s.wnext,he=s.wsize-pe):he=s.wnext-pe,pe>s.length&&(pe=s.length),fe=s.window}else fe=re,he=oe-s.offset,pe=s.length;pe>ie&&(pe=ie),ie-=pe,s.length-=pe;do re[oe++]=fe[he++];while(--pe);0===s.length&&(s.mode=X);break;case Q:if(0===ie)break inf_leave;re[oe++]=s.length,ie--,s.mode=X;break;case J:if(s.wrap){for(;32>de;){if(0===le)break inf_leave;le--,se|=d[ne++]<<de,de+=8}if(ue-=ie,t.total_out+=ue,s.total+=ue,ue&&(t.adler=s.check=s.flags?f(s.check,re,ue,oe-ue):h(s.check,re,ue,oe-ue)),ue=ie,(s.flags?se:o(se))!==s.check){t.msg='incorrect data check',s.mode=te;break}se=0,de=0}s.mode=$;case $:if(s.wrap&&s.flags){for(;32>de;){if(0===le)break inf_leave;le--,se+=d[ne++]<<de,de+=8}if(se!==(4294967295&s.total)){t.msg='incorrect length check',s.mode=te;break}se=0,de=0}s.mode=ee;case ee:xe=1;break inf_leave;case te:xe=E;break inf_leave;case ae:return k;case 32:default:return x;}return(t.next_out=oe,t.avail_out=ie,t.next_in=ne,t.avail_in=le,s.hold=se,s.bits=de,(s.wsize||ue!==t.avail_out&&s.mode<te&&(s.mode<J||a!==y))&&u(t,t.output,t.next_out,ue-t.avail_out))?(s.mode=ae,k):(ce-=t.avail_in,ue-=t.avail_out,t.total_in+=ce,t.total_out+=ue,s.total+=ue,s.wrap&&ue&&(t.adler=s.check=s.flags?f(s.check,re,ue,t.next_out-ue):h(s.check,re,ue,t.next_out-ue)),t.data_type=s.bits+(s.last?64:0)+(s.mode===L?128:0)+(s.mode===V||s.mode===U?256:0),(0===ce&&0===ue||a===y)&&xe===w&&(xe=-5),xe)},a.inflateEnd=function(e){if(!e||!e.state)return x;var t=e.state;return t.window&&(t.window=null),e.state=null,w},a.inflateGetHeader=function(e,t){var a;return e&&e.state?(a=e.state,0==(2&a.wrap))?x:(a.head=t,t.done=!1,w):x},a.inflateSetDictionary=function(e,t){var a=t.length,r,n,o;return e&&e.state?(r=e.state,0!==r.wrap&&r.mode!==O)?x:r.mode===O&&(n=1,n=h(n,t,a,0),n!==r.check)?E:(o=u(e,t,a,a),o)?(r.mode=ae,k):(r.havedict=1,w):x},a.inflateInfo='pako inflate (from Nodeca project)'},function(e){'use strict';var t=30;e.exports=function(e,a){var r,n,o,l,i,s,d,c,u,p,h,f,_,g,m,b,y,v,w,x,E,k,I,C,T;r=e.state,n=e.next_in,C=e.input,o=n+(e.avail_in-5),l=e.next_out,T=e.output,i=l-(a-e.avail_out),s=l+(e.avail_out-257),d=r.dmax,c=r.wsize,u=r.whave,p=r.wnext,h=r.window,f=r.hold,_=r.bits,g=r.lencode,m=r.distcode,b=(1<<r.lenbits)-1,y=(1<<r.distbits)-1;top:do{15>_&&(f+=C[n++]<<_,_+=8,f+=C[n++]<<_,_+=8),v=g[f&b];dolen:for(;;){if(w=v>>>24,f>>>=w,_-=w,w=255&v>>>16,0===w)T[l++]=65535&v;else if(16&w){x=65535&v,w&=15,w&&(_<w&&(f+=C[n++]<<_,_+=8),x+=f&(1<<w)-1,f>>>=w,_-=w),15>_&&(f+=C[n++]<<_,_+=8,f+=C[n++]<<_,_+=8),v=m[f&y];dodist:for(;;){if(w=v>>>24,f>>>=w,_-=w,w=255&v>>>16,16&w){if(E=65535&v,w&=15,_<w&&(f+=C[n++]<<_,_+=8,_<w&&(f+=C[n++]<<_,_+=8)),E+=f&(1<<w)-1,E>d){e.msg='invalid distance too far back',r.mode=t;break top}if(f>>>=w,_-=w,w=l-i,E>w){if(w=E-w,w>u&&r.sane){e.msg='invalid distance too far back',r.mode=t;break top}if(k=0,I=h,0===p){if(k+=c-w,w<x){x-=w;do T[l++]=h[k++];while(--w);k=l-E,I=T}}else if(p<w){if(k+=c+p-w,w-=p,w<x){x-=w;do T[l++]=h[k++];while(--w);if(k=0,p<x){w=p,x-=w;do T[l++]=h[k++];while(--w);k=l-E,I=T}}}else if(k+=p-w,w<x){x-=w;do T[l++]=h[k++];while(--w);k=l-E,I=T}for(;2<x;)T[l++]=I[k++],T[l++]=I[k++],T[l++]=I[k++],x-=3;x&&(T[l++]=I[k++],1<x&&(T[l++]=I[k++]))}else{k=l-E;do T[l++]=T[k++],T[l++]=T[k++],T[l++]=T[k++],x-=3;while(2<x);x&&(T[l++]=T[k++],1<x&&(T[l++]=T[k++]))}}else if(0==(64&w)){v=m[(65535&v)+(f&(1<<w)-1)];continue dodist}else{e.msg='invalid distance code',r.mode=t;break top}break}}else if(0==(64&w)){v=g[(65535&v)+(f&(1<<w)-1)];continue dolen}else if(32&w){r.mode=12;break top}else{e.msg='invalid literal/length code',r.mode=t;break top}break}}while(n<o&&l<s);return x=_>>3,n-=x,_-=x<<3,f&=(1<<_)-1,e.next_in=n,e.next_out=l,e.avail_in=n<o?5+(o-n):5-(n-o),e.avail_out=l<s?257+(s-l):257-(l-s),r.hold=f,void(r.bits=_)}},function(e,t,a){'use strict';var r=a(0),n=15,o=852,l=592,i=0,s=1,d=2,c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,a,f,_,g,m,b){var y=b.bits,v=0,w=0,x=0,E=0,k=0,I=0,C=0,T=0,S=0,R=0,D=null,B=0,P=new r.Buf16(n+1),A=new r.Buf16(n+1),z=null,N=0,O,L,M,F,U,W,j,H,G;for(v=0;v<=n;v++)P[v]=0;for(w=0;w<f;w++)P[t[a+w]]++;for(k=y,E=n;1<=E&&0===P[E];E--);if(k>E&&(k=E),0==E)return _[g++]=20971520,_[g++]=20971520,b.bits=1,0;for(x=1;x<E&&0===P[x];x++);for(k<x&&(k=x),T=1,v=1;v<=n;v++)if(T<<=1,T-=P[v],0>T)return-1;if(0<T&&(e===i||1!=E))return-1;for(A[1]=0,v=1;v<n;v++)A[v+1]=A[v]+P[v];for(w=0;w<f;w++)0!==t[a+w]&&(m[A[t[a+w]]++]=w);if(e===i?(D=z=m,W=19):e===s?(D=c,B-=257,z=u,N-=257,W=256):(D=p,z=h,W=-1),R=0,w=0,v=x,U=g,I=k,C=0,M=-1,S=1<<k,F=S-1,e===s&&S>o||e===d&&S>l)return 1;for(;;){j=v-C,m[w]<W?(H=0,G=m[w]):m[w]>W?(H=z[N+m[w]],G=D[B+m[w]]):(H=96,G=0),O=1<<v-C,L=1<<I,x=L;do L-=O,_[U+(R>>C)+L]=0|(j<<24|H<<16|G);while(0!==L);for(O=1<<v-1;R&O;)O>>=1;if(0===O?R=0:(R&=O-1,R+=O),w++,0==--P[v]){if(v==E)break;v=t[a+m[w]]}if(v>k&&(R&F)!==M){for(0==C&&(C=k),U+=x,I=v-C,T=1<<I;I+C<E&&(T-=P[I+C],!(0>=T));)I++,T<<=1;if(S+=1<<I,e===s&&S>o||e===d&&S>l)return 1;M=R&F,_[M]=0|(k<<24|I<<16|U-g)}}return 0!==R&&(_[U+R]=0|(4194304|v-C<<24)),b.bits=k,0}},function(e){'use strict';e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name='',this.comment='',this.hcrc=0,this.done=!1}},function(e,t){'use strict';var a=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var n=function(){function e(){}return e.prototype.decode=function(e){return a(this,void 0,void 0,function(){return r(this,function(){return[2,new Float32Array(e.buffer,e.byteOffset,e.byteLength/4)]})})},e}();t.default=n},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var a=-1,r=function(){function e(){this.scheduledCallbackId=a}return e.prototype.request=function(e){var t=this;this.fn=e,this.scheduledCallbackId==a&&(this.scheduledCallbackId=requestAnimationFrame(function(){return t.forceDispatch()}))},e.prototype.forceDispatch=function(){this.scheduledCallbackId==a||(this.cancel(),this.fn())},e.prototype.cancel=function(){this.scheduledCallbackId==a||(cancelAnimationFrame(this.scheduledCallbackId),this.scheduledCallbackId=a)},e}();t.default=r},function(e,t){'use strict';function a(e){for(var t=[],r=0,n;r<e.length;r++)n=e[r],n instanceof Array?t.splice(t.length,0,a(n)):t[t.length]=n;return t}Object.defineProperty(t,'__esModule',{value:!0});var r=function(){function e(e,t,a,r){if(void 0===e&&(e=null),void 0===t&&(t=0),void 0===r&&(r=null),this.placeholderContext=r,this._byteOffset=t,this._buffer=e,e)this._length=void 0===a?e.byteLength/this.BYTES_PER_ELEMENT:a;else{if(void 0===a)throw Error('"butter" or "length" must be specified.');this._length=a}if(this.isDynamic&&!r)throw Error('PlaceholderContext must be required when SymbolicTypedArray is initialized as dynamic buffer view.')}return Object.defineProperty(e.prototype,'buffer',{get:function(){return this._buffer||(this._buffer=new ArrayBuffer(this.byteOffset+this.byteLength)),this._buffer},set:function(e){this._buffer=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'byteLength',{get:function(){return this.length*this.BYTES_PER_ELEMENT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'offset',{get:function(){return this.byteOffset/this.BYTES_PER_ELEMENT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'isDynamic',{get:function(){return'number'!=typeof this._byteOffset||'number'!=typeof this._length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'length',{get:function(){return this.isDynamic?this.placeholderContext.resolve(this._length):this._length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,'byteOffset',{get:function(){return this.isDynamic?this.placeholderContext.resolve(this._byteOffset):this._byteOffset},enumerable:!0,configurable:!0}),e.prototype.copyWithin=function(e,t,a){return this.toActual().copyWithin(e,t,a),this},e.prototype.fill=function(e,t,a){return this.toActual().fill(e,t,a),this},e.prototype.indexOf=function(e,t){return this.toActual().indexOf(e,t)},e.prototype.join=function(e){return this.toActual().join(e)},e.prototype.lastIndexOf=function(e,t){return this.toActual().lastIndexOf(e,t)},e.prototype.sort=function(e){return this.toActual().sort(e),this},e.prototype.includes=function(e,t){return this.toActual().includes(e,t)},e.prototype.set=function(e,t){return this.toActual().set(a(e),t)},e.prototype.toLocaleString=function(){return this.toActual().toLocaleString()},e.prototype.toString=function(){return this.toActual().toString()},e.prototype[Symbol.iterator]=function(){return this.toActual()[Symbol.iterator]()},e.prototype.entries=function(){return this.toActual().entries()},e.prototype.keys=function(){return this.toActual().keys()},e.prototype.values=function(){return this.toActual().values()},e}();t.SymbolicTypedArray=r},function(e,t,a){'use strict';var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),n=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var l=a(2),i=a(3),s=a(4),d=a(5),c=a(6),u=a(7),p=function(e){function t(t){void 0===t&&(t={});var a=e.call(this,t)||this;if(a.backendName='webassembly',a.worker_promise_reject_func=null,a.worker_initial_error=null,'undefined'==typeof Worker)throw new Error('WebWorker is needed for WebAssembly backend');return'object'!=typeof WebAssembly&&console.warn('WebAssembly is not supported on this browser, trying to use asm.js code'),a}return r(t,e),t.checkAvailability=function(){return'Worker'in window},t.prototype.init=function(){if(!t.checkAvailability())throw Error('WebAssembly backend is not supported in this browser.');return Promise.resolve()},t.prototype.absolutePath=function(t){var a=document.createElement('span');return a.insertAdjacentHTML('beforeend','<a href="'+t+'" />'),a.firstChild.href},t.prototype.setDescriptorAndParameters=function(e,t){return n(this,void 0,void 0,function(){var a=this,r,n,l,i,s;return o(this,function(o){switch(o.label){case 0:return this.descriptor=e,this.placeholderContext=new d.default(this.descriptor.placeholders),r='object'==typeof WebAssembly?'webassembly':'asmjs',0<=window.navigator.userAgent.indexOf('iPhone OS 11_2')&&(r='asmjs'),n=this.directory+'/kernels_'+r+'.js',n=this.transformUrlDelegate(n),this.worker_entry_js_path=n,[4,fetch(this.worker_entry_js_path)];case 1:return l=o.sent(),[4,l.text()];case 2:return i=o.sent(),s=function(e,t){var r=a.absolutePath(a.directory+'/'+e),n=a.transformUrlDelegate(r);i=i.replace(t,n)},'webassembly'===r?s('kernels_webassembly.wasm','WEBDNN_URL_KERNELS_WASM'):s('kernels_asmjs.js.mem','WEBDNN_URL_KERNELS_ASMJS_MEM'),[4,this.compile(i)];case 3:return o.sent(),[4,this.loadWeights(new Uint8Array(t))];case 4:return o.sent(),[4,this.getInputViews()];case 5:return o.sent().filter(function(e){return!e.isDynamic}).forEach(function(e){e.buffer=new Float32Array(e.length).buffer}),[4,this.getOutputViews()];case 6:return o.sent().filter(function(e){return!e.isDynamic}).forEach(function(e){e.buffer=new Float32Array(e.length).buffer}),[2];}})})},t.prototype.fetchDescriptor=function(e){return n(this,void 0,void 0,function(){var t;return o(this,function(a){switch(a.label){case 0:return this.directory=e,[4,s.default(e+'/graph_'+this.backendName+'.json',this.transformUrlDelegate)];case 1:return t=a.sent(),[2,t.json()];}})})},t.prototype.fetchParameters=function(e,t){return n(this,void 0,void 0,function(){var a,r;return o(this,function(n){switch(n.label){case 0:return a=e+'/weight_'+this.backendName+'.bin',[4,s.default(a,this.transformUrlDelegate)];case 1:return r=n.sent(),[2,s.readArrayBufferProgressively(r,t)];}})})},t.prototype.restoreCachedDescriptor=function(e){return n(this,void 0,void 0,function(){return o(this,function(){return this.directory=e,[2,l.getItem(e+'_'+this.backendName+'_descriptor').catch(function(){return null})]})})},t.prototype.restoreCachedParameters=function(e,t){return n(this,void 0,void 0,function(){var a;return o(this,function(r){switch(r.label){case 0:return[4,l.getItem(e+'_'+this.backendName+'_parameters').catch(function(){return null})];case 1:return a=r.sent(),a&&t&&t(a.byteLength,a.byteLength),[2,a];}})})},t.prototype.saveCache=function(e,t,a){return n(this,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return[4,Promise.all([l.setItem(e+'_'+this.backendName+'_descriptor',t),l.setItem(e+'_'+this.backendName+'_parameters',a)])];case 1:return r.sent(),[2];}})})},(t.prototype.setPlaceholderValue=function(e){return n(this,void 0,void 0,function(){var t,a,r,n,l,i,s;return o(this,function(o){switch(o.label){case 0:if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized.');if(t=this.placeholderContext,t.update(e),!t.isResolved)return[2];if(!this.descriptor)throw new Error('Descriptor is not loaded');for(a=this.descriptor,r=a.unresolved_value_lists,n=[],l=function(e){var a=r[e];a.forEach(function(a){var r=t.resolve(a.placeholder);n.push(e,a.offset,r)})},i=0;i<r.length;i++)l(i);return[4,this.getInputViews()];case 1:return o.sent().filter(function(e){return e.isDynamic}).forEach(function(e){e.buffer=new Float32Array(e.length).buffer}),[4,this.getOutputViews()];case 2:return o.sent().filter(function(e){return e.isDynamic}).forEach(function(e){e.buffer=new Float32Array(e.length).buffer}),s=this.placeholderContext.resolve(this.descriptor.memory_layout.dynamic.size),[4,this.setPlaceholderValueWorker(s,new Int32Array(n))];case 3:return o.sent(),[2];}})})},t.prototype.setPlaceholderValueWorker=function(e,t){if(!this.worker)throw Error('Worker is not initialized');var a=this.worker;return new Promise(function(r,n){a.onmessage=function(e){0===e.data?r():(console.log(e.data),a.terminate(),n(new Error(e.data)))},a.postMessage({type:'set_dynamic_buffer',size:e,data:t})})},t.prototype.compile=function(e){var t=this,a=new Blob([e],{type:'text/javascript'}),r=URL.createObjectURL(a),n=new Worker(r);n.onerror=function(e){console.error(e),t.worker_promise_reject_func?t.worker_promise_reject_func(e):t.worker_initial_error=e};var o=new Promise(function(e,a){return t.worker_initial_error?a(t.worker_initial_error):void(t.worker_promise_reject_func=a,n.onmessage=function(t){0===t.data?e():(console.error(t.data),n.terminate(),a(new Error(t.data)))})});return this.worker=n,o},t.prototype.loadWeights=function(e){return n(this,void 0,void 0,function(){var t=this,a,r,n,l;return o(this,function(o){switch(o.label){case 0:if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.worker)throw new Error('Worker is not initialized');return a=i.default(this.descriptor.weight_encoding),[4,a.decode(e)];case 1:return r=o.sent(),n=this.worker,l=new Promise(function(e,a){t.worker_promise_reject_func=a,n.onmessage=function(t){0===t.data?e():(console.log(t.data),n.terminate(),a(new Error(t.data)))},n.postMessage({type:'weight',data:r},[r.buffer])}),[2,l];}})})},t.prototype.getInputViews=function(){if(this.inputs)return this.inputs;if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');var e=this.descriptor,t=this.placeholderContext;return this.inputs=e.inputs.map(function(a){var r=e.memory_layout.static.allocations[a]||e.memory_layout.dynamic.allocations[a],n=new c.default(null,0,r.size,t);return n}),this.inputs},t.prototype.getOutputViews=function(){if(this.outputs)return this.outputs;if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');var e=this.descriptor,t=this.placeholderContext;return this.outputs=e.outputs.map(function(a){var r=e.memory_layout.static.allocations[a]||e.memory_layout.dynamic.allocations[a],n=new c.default(null,0,r.size,t);return n}),this.outputs},t.prototype.run=function(){return n(this,void 0,void 0,function(){var e=this,t,a,r,n;return o(this,function(){if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.worker)throw new Error('Worker is not initialized');if(!this.placeholderContext.isResolved)throw new Error('Not all placeholder is resolved');return t=this.placeholderContext,a=this.descriptor,r=this.worker,n=new Promise(function(n,o){e.worker_promise_reject_func=o,r.onmessage=function(t){if(Array.isArray(t.data)){for(var a=0;a<t.data.length;a++)e.outputs[a].set(t.data[a]);n()}else console.log(t.data),r.terminate(),o(new Error(t.data))};for(var l=[a.memory_layout.static.allocations,a.memory_layout.dynamic.allocations],s=[],d=0;d<a.inputs.length;d++)for(var i=0,c;2>i;i++)if(c=l[i][a.inputs[d]],c){var u=e.inputs[d];s.push({space:i,offset:t.resolve(c.offset),size:u.length,data:u.toActual()});break}for(var p=[],d=0;d<a.outputs.length;d++)for(var i=0,c;2>i;i++)if(c=l[i][a.outputs[d]],c){var u=e.outputs[d];p.push({space:i,offset:t.resolve(c.offset),size:u.length});break}r.postMessage({type:'run',inputs:s,outputs:p})}),[2,n]})})},t)}(u.DescriptorRunner);t.default=p},function(e,t,a){'use strict';var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),n=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var l=a(2),i=a(38),s=a(3),d=a(4),c=a(5),u=a(6),p=a(1),h=a(14),f=a(7),_=new Float32Array([-1,1,-1,-1,1,1,1,-1]),g=function(e){function t(t){void 0===t&&(t={});var a=e.call(this,t)||this;return a.backendName='webgl',a}return r(t,e),t.checkAvailability=function(){return h.default.checkAvailability()},t.prototype.init=function(){return n(this,void 0,void 0,function(){var e;return o(this,function(){if(!t.checkAvailability())throw Error('WebGL backend is not supported in this browser.');return this.handler=h.default.getInstance(),e=this.handler.createArrayBuffer(_),this.handler.bindArrayBuffer(e),this.buffers=new Map,[2]})})},t.prototype.fetchDescriptor=function(e){return n(this,void 0,void 0,function(){var t;return o(this,function(a){switch(a.label){case 0:return[4,d.default(e+'/graph_'+this.backendName+'_'+this.handler.MAX_TEXTURE_SIZE+'.json',this.transformUrlDelegate)];case 1:return t=a.sent(),[2,t.json()];}})})},t.prototype.fetchParameters=function(e,t){return n(this,void 0,void 0,function(){var a;return o(this,function(r){switch(r.label){case 0:return[4,d.default(e+'/weight_'+this.backendName+'_'+this.handler.MAX_TEXTURE_SIZE+'.bin',this.transformUrlDelegate)];case 1:return a=r.sent(),[2,d.readArrayBufferProgressively(a,t)];}})})},t.prototype.restoreCachedDescriptor=function(e){return n(this,void 0,void 0,function(){return o(this,function(){return[2,l.getItem(e+'_'+this.backendName+'_'+this.handler.MAX_TEXTURE_SIZE+'_descriptor').catch(function(){return null})]})})},t.prototype.restoreCachedParameters=function(e,t){return n(this,void 0,void 0,function(){var a;return o(this,function(r){switch(r.label){case 0:return[4,l.getItem(e+'_'+this.backendName+'_'+this.handler.MAX_TEXTURE_SIZE+'_parameters').catch(function(){return null})];case 1:return a=r.sent(),a&&t&&t(a.byteLength,a.byteLength),[2,a];}})})},t.prototype.saveCache=function(e,t,a){return n(this,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return[4,Promise.all([l.setItem(e+'_'+this.backendName+'_'+this.handler.MAX_TEXTURE_SIZE+'_descriptor',t),l.setItem(e+'_'+this.backendName+'_'+this.handler.MAX_TEXTURE_SIZE+'_parameters',a)])];case 1:return r.sent(),[2];}})})},(t.prototype.setDescriptorAndParameters=function(e,t){return n(this,void 0,void 0,function(){return o(this,function(a){switch(a.label){case 0:return[4,this.setDescriptor(e)];case 1:return a.sent(),[4,this.compile()];case 2:return a.sent(),[4,this.initializeStaticBuffer(t)];case 3:return a.sent(),this.placeholderContext&&this.placeholderContext.isResolved?[4,this.initializeDynamicBuffer()]:[3,5];case 4:a.sent(),a.label=5;case 5:return[2];}})})},t.prototype.initializeStaticBuffer=function(e){return n(this,void 0,void 0,function(){var t,a,r,n,l;return o(this,function(o){switch(o.label){case 0:if(!this.descriptor)throw new Error('Descriptor is not loaded');return t=this.descriptor,a=s.default(this.descriptor.weight_encoding),[4,a.decode(new Uint8Array(e))];case 1:return r=o.sent(),n=this.buffers,l=t.memory_layout.mapping,Object.entries(t.memory_layout.static.allocations).forEach(function(e){var t=e[0],a=e[1],r=a.width,o=a.height,l=a.size,s=a.channel_mode;n.set(t,new i.default(l*Float32Array.BYTES_PER_ELEMENT,r,o,t,null,s))}),Object.entries(t.constants_map).forEach(function(e){var t=e[0],a=e[1],o=a.size,l=a.byte_offset;n.get(t).array.set(new Float32Array(r.buffer,l,o))}),[4,this.getInputViews()];case 2:return o.sent().filter(function(e){return!e.isDynamic}).forEach(function(e){e.buffer=n.get(l[e.name]).getWriteView(0,e.length,Float32Array).buffer}),[4,this.getOutputViews()];case 3:return o.sent().filter(function(e){return!e.isDynamic}).forEach(function(e){e.buffer=n.get(l[e.name]).getReadView(0,e.length,Float32Array).buffer}),[2];}})})},t.prototype.initializeDynamicBuffer=function(){return n(this,void 0,void 0,function(){var e,t,a,r;return o(this,function(n){switch(n.label){case 0:if(!this.descriptor)throw Error('GraphDescriptor is not loaded.');if(!this.placeholderContext)throw Error('PlaceholderContext is not initialized.');return e=this.descriptor,t=this.placeholderContext,a=this.buffers,r=e.memory_layout.mapping,Object.entries(e.memory_layout.dynamic.allocations).forEach(function(e){var r=e[0],n=e[1],o=n.width,l=n.height,s=n.size,d=n.channel_mode;a.set(r,new i.default(t.resolve(s)*Float32Array.BYTES_PER_ELEMENT,t.resolve(o),t.resolve(l),r,null,d))}),[4,this.getInputViews()];case 1:return n.sent().filter(function(e){return e.isDynamic}).forEach(function(e){e.buffer=a.get(r[e.name]).getWriteView(0,t.resolve(e.length),Float32Array).buffer}),[4,this.getOutputViews()];case 2:return n.sent().filter(function(e){return e.isDynamic}).forEach(function(e){e.buffer=a.get(r[e.name]).getReadView(0,t.resolve(e.length),Float32Array).buffer}),this.buildPipeline(),[2];}})})},t.prototype.setDescriptor=function(e){return n(this,void 0,void 0,function(){return o(this,function(){return this.descriptor=e,this.placeholderContext=new c.default(e.placeholders),[2]})})},t.prototype.compile=function(){return n(this,void 0,void 0,function(){var e=this,t;return o(this,function(){if(!this.descriptor)throw new Error('Descriptor is not loaded');return t=this.descriptor,this.programs=new Map,this.vertexShader=this.handler.createVertexShader('\n            precision highp float;\n            attribute vec2 _xy;\n            void main() { \n              gl_Position = vec4(_xy, 0, 1); \n            }\n        '),Object.keys(t.shader_sources).forEach(function(a){var r=e.handler.createFragmentShader(t.shader_sources[a]),n=e.handler.createProgram(e.vertexShader,r);e.programs.set(a,n)}),[2]})})},t.prototype.setPlaceholderValue=function(e){return n(this,void 0,void 0,function(){var t;return o(this,function(a){switch(a.label){case 0:if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized.');if(t=this.placeholderContext,t.update(e),!t.isResolved)return[2];if(!this.descriptor)throw new Error('Descriptor is not loaded');return[4,this.initializeDynamicBuffer()];case 1:if(a.sent(),0<Object.keys(this.descriptor.placeholders).length)throw Error('Currently, WebGL backend doesn\'t support Placeholder feature.');return[2];}})})},t.prototype.getInputViews=function(){var e=this;if(this.inputs)return this.inputs;if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');var t=this.descriptor,a=this.placeholderContext,r=this.descriptor.memory_layout.mapping;return this.inputs=t.inputs.map(function(t){var n=new u.default(null,0,e.buffers.get(r[t]).length,a);return n.name=t,n}),this.inputs},t.prototype.getOutputViews=function(){var e=this;if(this.outputs)return this.outputs;if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');var t=this.descriptor,a=this.placeholderContext,r=this.descriptor.memory_layout.mapping;return this.outputs=t.outputs.map(function(t){var n=new u.default(null,0,e.buffers.get(r[t]).length,a);return n.name=t,n}),this.outputs},t.prototype.buildPipeline=function(){var e=this;if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');if(!this.placeholderContext.isResolved)throw new Error('Not all placeholders are resolved: '+this.placeholderContext);var t=this.handler.gl,a=this.buffers,r=this.descriptor.memory_layout.mapping,n=new Map;this.runtimeInfo={inputs:this.getInputViews().map(function(e){return a.get(r[e.name])}),outputs:this.getOutputViews().map(function(e){return a.get(r[e.name])}),programs:this.descriptor.exec_infos.map(function(o){var l=o.inputs.map(function(e){var t=a.get(r[e.variable_name]);return n.has(t)||n.set(t,0),n.set(t,n.get(t)+1),{buffer:t,uniformIndex:e.value}}),i=a.get(r[o.output]),s=e.programs.get(o.shader_name);e.handler.useProgram(s);var d=Object.keys(o.uniforms).map(function(e){var a=o.uniforms[e],r=a.type,n=a.value;switch(r){case'int':return{func:t.uniform1i,args:[t.getUniformLocation(s,e),n]};case'float':return{func:t.uniform1f,args:[t.getUniformLocation(s,e),n]};case'vec2':return{func:t.uniform2fv,args:[t.getUniformLocation(s,e),n]};case'vec3':return{func:t.uniform3fv,args:[t.getUniformLocation(s,e),n]};case'vec4':return{func:t.uniform4fv,args:[t.getUniformLocation(s,e),n]};case'ivec2':return{func:t.uniform2iv,args:[t.getUniformLocation(s,e),n]};case'ivec3':return{func:t.uniform3iv,args:[t.getUniformLocation(s,e),n]};case'ivec4':return{func:t.uniform4iv,args:[t.getUniformLocation(s,e),n]};case'sampler2D':return{func:t.uniform1i,args:[t.getUniformLocation(s,e),n]};default:throw TypeError('Incompatible type for uniform parameter: '+r);}}),c=t.getAttribLocation(s,'_xy');return{program:s,frameBuffer:e.handler.createFrameBuffer(),name:o.shader_name,width:i.textureWidth,height:i.textureHeight,inputs:l,output:i,xyAttribLoc:c,uniforms:d,disposable:[]}})};for(var o=function(e){e.inputs.forEach(function(t){var a=t.buffer,r=n.get(a)-1;0==r&&e.disposable.push(a),n.set(a,r)})},l=0,i=this.runtimeInfo.programs,s;l<i.length;l++)s=i[l],o(s)},t.prototype.run=function(){return n(this,void 0,void 0,function(){var e,t,a,r,n,l,i,s,d,c,u,h,f,g,n,m,b,v,w,x,E,k,I,n,C,T,S,R,c,D,B,P,n,m,A,z,w,N,O,n,L,M,n;return o(this,function(o){switch(o.label){case 0:if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');if(!this.placeholderContext.isResolved)throw new Error('Not all placeholders are resolved: '+this.placeholderContext);if(e=this.handler.gl,t=this.runtimeInfo,!(0<this.runtimeInfo.programs.length))return[3,29];a=0,r=t.inputs,o.label=1;case 1:return a<r.length?(n=r[a],[4,n.syncWriteViews()]):[3,4];case 2:o.sent(),o.label=3;case 3:return a++,[3,1];case 4:if(!p.getConfiguration('DEBUG',!1))return[3,18];l=[],i=0,s=0,d=t.programs,o.label=5;case 5:if(!(s<d.length))return[3,17];c=d[s],u=performance.now(),this.handler.bindFrameBuffer(c.frameBuffer,c.width,c.height),h=0,f=c.inputs,o.label=6;case 6:return h<f.length?(g=f[h],n=g.buffer,m=g.uniformIndex,[4,n.bindToReadTexture(m)]):[3,9];case 7:o.sent(),o.label=8;case 8:return h++,[3,6];case 9:for(c.output.bindToDrawTexture(),this.handler.useProgram(c.program),(b=0,v=c.uniforms);b<v.length;b++)w=v[b],w.func.apply(e,w.args);return e.vertexAttribPointer(c.xyAttribLoc,2,e.FLOAT,!0,8,0),e.enableVertexAttribArray(c.xyAttribLoc),e.drawArrays(e.TRIANGLE_STRIP,0,_.length/2),[4,this.handler.waitForComplete()];case 10:o.sent(),x=performance.now()-u,i+=x,E=[],k=0,I=c.inputs,o.label=11;case 11:return k<I.length?(n=I[k].buffer,n.unbindFromReadTexture(),[4,n.syncReadViews()]):[3,14];case 12:o.sent(),E.push(n.array.slice()),o.label=13;case 13:return k++,[3,11];case 14:return c.output.unbindFromDrawTexture(),[4,c.output.syncReadViews()];case 15:o.sent(),C=c.output.array.slice(),l.push({Kernel:c.name,"Elapsed time [ms]":x,xs:E,y:C}),o.label=16;case 16:return s++,[3,5];case 17:return T=Array.from(Object.values(l.reduce(function(e,t){return t.Kernel in e||(e[t.Kernel]={Kernel:t.Kernel,Count:0,"Elapsed time [ms]":0}),e[t.Kernel].Count++,e[t.Kernel]['Elapsed time [ms]']+=t['Elapsed time [ms]'],e},{}))),T.forEach(function(e){return e['Ratio [%]']=(e['Elapsed time [ms]']/i).toFixed(2)}),console.table(l),console.table(T),[3,25];case 18:S=0,R=t.programs,o.label=19;case 19:if(!(S<R.length))return[3,25];c=R[S],this.handler.bindFrameBuffer(c.frameBuffer,c.width,c.height),D=0,B=c.inputs,o.label=20;case 20:return D<B.length?(P=B[D],n=P.buffer,m=P.uniformIndex,[4,n.bindToReadTexture(m)]):[3,23];case 21:o.sent(),o.label=22;case 22:return D++,[3,20];case 23:for(c.output.bindToDrawTexture(),this.handler.useProgram(c.program),(A=0,z=c.uniforms);A<z.length;A++)w=z[A],w.func.apply(e,w.args);for(e.vertexAttribPointer(c.xyAttribLoc,2,e.FLOAT,!0,8,0),e.enableVertexAttribArray(c.xyAttribLoc),e.drawArrays(e.TRIANGLE_STRIP,0,_.length/2),(N=0,O=c.inputs);N<O.length;N++)n=O[N].buffer,n.unbindFromReadTexture();c.output.unbindFromDrawTexture(),o.label=24;case 24:return S++,[3,19];case 25:L=0,M=t.outputs,o.label=26;case 26:return L<M.length?(n=M[L],[4,n.syncReadViews()]):[3,29];case 27:o.sent(),o.label=28;case 28:return L++,[3,26];case 29:return[2];}})})},t)}(f.DescriptorRunner);t.default=g},function(e,t,a){'use strict';var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),n=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var l=a(14),i=a(15),s=function(e){function t(t,a,r,n,o,i){var s=e.call(this,t,'webgl')||this;switch(s._texture=null,s.readTextureUnitIndices=[],s.isBoundToDrawFrameBuffer=!1,s.handler=l.default.getInstance(),s.name=n,s.channelMode=i,i){case'RGBA':s.elementsPerPixel=4;break;case'R':s.elementsPerPixel=1;break;default:throw Error('Unknown channel mode');}if(l.isWebGL2(s.handler.gl))switch(i){case'RGBA':s.textureFormat=s.handler.gl.RGBA,s.textureInternalFormat=s.handler.gl.RGBA32F,s.pixelStride=4;break;case'R':s.textureFormat=s.handler.gl.RED,s.textureInternalFormat=s.handler.gl.R32F,s.pixelStride=1;break;default:throw Error('Unknown channel mode');}else s.textureFormat=s.handler.gl.RGBA,s.textureInternalFormat=s.handler.gl.RGBA,s.pixelStride=4;if(s.pixelStride<s.elementsPerPixel)throw Error('elementsPerPixel must be smaller than pixelStride');return s.array=o||new Float32Array(s.length),s.textureWidth=a,s.textureHeight=r,s}return r(t,e),Object.defineProperty(t.prototype,'texture',{get:function(){return this._texture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,'length',{get:function(){return this.byteLength/Float32Array.BYTES_PER_ELEMENT},enumerable:!0,configurable:!0}),t.prototype.write=function(e,t){return n(this,void 0,void 0,function(){return o(this,function(a){switch(a.label){case 0:return this.array.set(e,t),[4,this.syncWriteViews()];case 1:return a.sent(),[2];}})})},t.prototype.read=function(e,t,a){return void 0===t&&(t=0),n(this,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:if(e!==Float32Array)throw new Error('Currently, only Float32Array is supported for parameter \'dst\'.');return[4,this.syncReadViews()];case 1:return r.sent(),new Float32Array(this.array.buffer,t*Float32Array.BYTES_PER_ELEMENT,a),[2];}})})},t.prototype.getWriteView=function(e,t,a){return new a(this.array.buffer,e*a.BYTES_PER_ELEMENT,t)},(t.prototype.getReadView=function(e,t,a){return new a(this.array.buffer,e*a.BYTES_PER_ELEMENT,t)},t.prototype.syncWriteViews=function(){return n(this,void 0,void 0,function(){var e,t,a;return o(this,function(r){switch(r.label){case 0:return e=this.handler.gl,this.texture||this.allocateTexture(),t=this.pack(this.array),t.length!=this.textureWidth*this.textureHeight*this.pixelStride&&(a=new Float32Array(this.textureWidth*this.textureHeight*this.pixelStride),a.set(t,0),t=a),[4,this.bindToReadTexture(9)];case 1:return r.sent(),e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.textureWidth,this.textureHeight,this.textureFormat,e.FLOAT,t),this.unbindFromReadTexture(),[2];}})})},t.prototype.syncReadViews=function(){return n(this,void 0,void 0,function(){var e,t,a,r;return o(this,function(){return e=this.handler.gl,t=4,a=e.RGBA,r=new Float32Array(this.textureWidth*this.textureHeight*t),this.bindToDrawTexture(),e.readPixels(0,0,this.textureWidth,this.textureHeight,a,e.FLOAT,r),this.unbindFromDrawTexture(),r=this.unpack(r),this.array.set(r.slice(0,this.length),0),[2]})})},t.prototype.bindToReadTexture=function(e){return n(this,void 0,void 0,function(){var t;return o(this,function(a){switch(a.label){case 0:if(this.isBoundToDrawFrameBuffer)throw Error('This buffer is already registered as draw buffer. You may forgot to unbind the binding while previous operations.');return(t=this.handler.gl,!!this.texture)?[3,2]:(this.allocateTexture(),[4,this.syncWriteViews()]);case 1:a.sent(),a.label=2;case 2:return t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.texture),this.readTextureUnitIndices.push(e),[2];}})})},t.prototype.unbindFromReadTexture=function(){for(var e=this.handler.gl,t=0,a=this.readTextureUnitIndices,r;t<a.length;t++)r=a[t],e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,null);this.readTextureUnitIndices=[]},t.prototype.bindToDrawTexture=function(){if(0<this.readTextureUnitIndices.length)throw Error('This buffer is already registered as read buffer. You cannot bind a texture as both read and draw texture buffer at same time.');if(this.isBoundToDrawFrameBuffer)throw Error('This buffer is already registered as draw buffer. You may forgot to unbind the binding while previous operations.');var e=this.handler.gl;this.texture||this.allocateTexture(),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0),this.isBoundToDrawFrameBuffer=!0},t.prototype.unbindFromDrawTexture=function(){if(this.isBoundToDrawFrameBuffer){var e=this.handler.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0),this.isBoundToDrawFrameBuffer=!1}},t.prototype.pack=function(e){var t=this.pixelStride/this.elementsPerPixel;if(1==t)return new Float32Array(e);for(var a=new Float32Array(e.length*t),r=0;r<e.length;r++)a[r*t]=e[r];return a},t.prototype.unpack=function(e){var t=4/this.elementsPerPixel;if(1==t)return new Float32Array(e);for(var a=new Float32Array(e.length/t),r=0;r<e.length/t;r++)a[r]=e[r*t];return a},t.prototype.allocateTexture=function(){if(this.texture)throw Error('Texture is already allocated.');this._texture=this.handler.createTexture(this.textureWidth,this.textureHeight,this.textureInternalFormat,this.textureFormat)},t)}(i.Buffer);t.default=s},function(e,t,a){'use strict';var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),n=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var l=a(2),i=a(16),s=a(3),d=a(4),c=a(5),u=a(6),p=a(1),h=a(17),f=a(7),_=navigator.userAgent.includes('iPhone')||navigator.userAgent.includes('iPad'),g=function(e){function t(t){void 0===t&&(t={});var a=e.call(this,t)||this;return a.backendName='webgpu',a}return r(t,e),t.checkAvailability=function(){return h.IS_WEBGPU_SUPPORTED},t.prototype.init=function(){return n(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return this.webgpuHandler=h.default.getInstance(),[4,this.checkIncompatibleGPU()];case 1:return e.sent(),[2];}})})},t.prototype.checkIncompatibleGPU=function(){return n(this,void 0,void 0,function(){var e,t;return o(this,function(a){switch(a.label){case 0:return this.webgpuHandler.loadKernel('\n#include <metal_stdlib>\nusing namespace metal;\n        kernel void check_compatibility(\n            device uint *A[[buffer(0)]],\n            uint global_index[[thread_position_in_grid]],\n            uint thread_execution_width[[thread_execution_width]]\n        ){\n            if (global_index == 0) {\n                A[0] = thread_execution_width;\n            }\n        }','basic'),e=this.webgpuHandler.createBuffer(new Uint32Array(1)),[4,this.webgpuHandler.executeSinglePipelineState('basic.check_compatibility',{width:1,height:1,depth:1},{width:1,height:1,depth:1},[e],!0)];case 1:if(a.sent(),t=new Uint32Array(e.contents)[0],32!=t)throw new Error('Sorry, this GPU does not compatible with WebGPU (thread_execution_width == '+t+'. See checkIncompatibleGPU method of https://github.com/mil-tokyo/webdnn/blob/master/src/descriptor_runner/descriptor_runner/descriptor_runner_webgpu.ts');return[2];}})})},t.prototype.fetchDescriptor=function(e){return n(this,void 0,void 0,function(){var t;return o(this,function(a){switch(a.label){case 0:return[4,d.default(e+'/graph_'+this.backendName+'.json',this.transformUrlDelegate)];case 1:return t=a.sent(),[2,t.json()];}})})},t.prototype.fetchParameters=function(e,t){return n(this,void 0,void 0,function(){var a;return o(this,function(r){switch(r.label){case 0:return[4,d.default(e+'/weight_'+this.backendName+'.bin',this.transformUrlDelegate)];case 1:return a=r.sent(),[2,d.readArrayBufferProgressively(a,t)];}})})},t.prototype.restoreCachedDescriptor=function(e){return n(this,void 0,void 0,function(){return o(this,function(){return[2,l.getItem(e+'_'+this.backendName+'_descriptor').catch(function(){return null})]})})},t.prototype.restoreCachedParameters=function(e,t){return n(this,void 0,void 0,function(){var a;return o(this,function(r){switch(r.label){case 0:return[4,l.getItem(e+'_'+this.backendName+'_parameters').catch(function(){return null})];case 1:return a=r.sent(),a&&t&&t(a.byteLength,a.byteLength),[2,a];}})})},t.prototype.saveCache=function(e,t,a){return n(this,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return[4,Promise.all([l.setItem(e+'_'+this.backendName+'_descriptor',t),l.setItem(e+'_'+this.backendName+'_parameters',a)])];case 1:return r.sent(),[2];}})})},(t.prototype.setDescriptorAndParameters=function(e,t){return n(this,void 0,void 0,function(){return o(this,function(a){switch(a.label){case 0:return this.descriptor=e,this.staticBuffer=null,this.dynamicBuffer=null,this.metaBuffers=null,this.placeholderContext=new c.default(e.placeholders),this.executionInfos=e.exec_infos,this.webgpuHandler.loadKernel(this.descriptor.kernel_source,'descriptor'),[4,this.initializeStaticBuffer(t)];case 1:return a.sent(),[4,this.initializeMetaBuffers()];case 2:return a.sent(),[4,this.setPlaceholderValue({__MAX_THREADS_PER_THREADGROUP__:_?512:1024})];case 3:return a.sent(),this.placeholderContext&&this.placeholderContext.isResolved?[4,this.initializeDynamicBuffer()]:[3,5];case 4:a.sent(),a.label=5;case 5:return[2];}})})},t.prototype.initializeStaticBuffer=function(e){return n(this,void 0,void 0,function(){var t,a,r,n,l;return o(this,function(o){switch(o.label){case 0:if(!this.descriptor)throw Error('GraphDescriptor is not loaded.');return t=this.descriptor,a=new i.default(t.memory_layout.static.size*Float32Array.BYTES_PER_ELEMENT),this.staticBuffer=a,r=s.default(t.weight_encoding),l=(n=a).write,[4,r.decode(new Uint8Array(e))];case 1:return[4,l.apply(n,[o.sent()])];case 2:return o.sent(),[4,this.getInputViews()];case 3:return o.sent().filter(function(e){return!e.isDynamic}).forEach(function(e){e.buffer=a.bufferView.buffer}),[4,this.getOutputViews()];case 4:return o.sent().filter(function(e){return!e.isDynamic}).forEach(function(e){e.buffer=a.bufferView.buffer}),[2];}})})},t.prototype.initializeMetaBuffers=function(){return n(this,void 0,void 0,function(){var e=this,t;return o(this,function(a){switch(a.label){case 0:if(!this.descriptor)throw Error('GraphDescriptor is not loaded.');return t=this,[4,Promise.all(this.descriptor.exec_infos.map(function(t){return n(e,void 0,void 0,function(){var e;return o(this,function(a){switch(a.label){case 0:return e=new i.default(t.meta_buffer.length*Int32Array.BYTES_PER_ELEMENT),[4,e.write(new Uint8Array(t.meta_buffer))];case 1:return a.sent(),[2,e];}})})}))];case 1:return t.metaBuffers=a.sent(),[2];}})})},t.prototype.initializeDynamicBuffer=function(){return n(this,void 0,void 0,function(){var e,t,a,r;return o(this,function(n){switch(n.label){case 0:if(!this.descriptor)throw Error('GraphDescriptor is not loaded.');if(!this.placeholderContext)throw Error('PlaceholderContext is not initialized.');return e=this.descriptor,t=this.placeholderContext,a=t.resolve(e.memory_layout.dynamic.size),r=new i.default(a*Float32Array.BYTES_PER_ELEMENT),this.dynamicBuffer=r,[4,this.getInputViews()];case 1:return n.sent().filter(function(e){return e.isDynamic}).forEach(function(e){e.buffer=r.bufferView.buffer}),[4,this.getOutputViews()];case 2:return n.sent().filter(function(e){return e.isDynamic}).forEach(function(e){e.buffer=r.bufferView.buffer}),[2];}})})},t.prototype.setPlaceholderValue=function(e){return n(this,void 0,void 0,function(){var t=this,a,r,l,i;return o(this,function(s){switch(s.label){case 0:if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized.');if(a=this.placeholderContext,a.update(e),!a.isResolved)return[2];if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.metaBuffers)throw new Error('MetaBuffers are not initialized');return r=this.descriptor,l=this.metaBuffers,[4,this.initializeDynamicBuffer()];case 1:return s.sent(),i=this,[4,Promise.all(r.exec_infos.map(function(e,r){return n(t,void 0,void 0,function(){var t,n,i,s;return o(this,function(){for(t=new Int32Array(l[r].bufferView.buffer),n=0,i=e.unresolved_value_list;n<i.length;n++)s=i[n],t[s.offset]=a.resolve(s.placeholder);return[2,a.resolve(e)]})})}))];case 2:return i.executionInfos=s.sent(),[2];}})})},t.prototype.getInputViews=function(){if(this.inputs)return this.inputs;if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');var e=this.descriptor,t=this.placeholderContext;return this.inputs=e.inputs.map(function(a){var r=e.memory_layout.static.allocations[a]||e.memory_layout.dynamic.allocations[a],n=new u.default(null,r.offset*u.default.BYTES_PER_ELEMENT,r.size,t);return n}),this.inputs},t.prototype.getOutputViews=function(){if(this.outputs)return this.outputs;if(!this.descriptor)throw new Error('Descriptor is not loaded');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');var e=this.descriptor,t=this.placeholderContext;return this.outputs=e.outputs.map(function(a){var r=e.memory_layout.static.allocations[a]||e.memory_layout.dynamic.allocations[a],n=new u.default(null,r.offset*u.default.BYTES_PER_ELEMENT,r.size,t);return n}),this.outputs},t.prototype.run=function(){return n(this,void 0,void 0,function(){var e,t,a,r,n,l,i,s,d,c,u,l,i,h;return o(this,function(o){switch(o.label){case 0:if(!this.executionInfos)throw new Error('ExecutionInfos is not loaded');if(!this.staticBuffer)throw new Error('StaticBuffer is not initialized');if(!this.dynamicBuffer)throw new Error('DynamicBuffer is not initialized');if(!this.metaBuffers)throw new Error('MetaBuffer is not initialized');if(!this.placeholderContext)throw new Error('PlaceholderContext is not initialized');if(!this.placeholderContext.isResolved)throw new Error('Not all placeholders are resolved: '+this.placeholderContext);if(e=this.staticBuffer,t=this.dynamicBuffer,a=this.metaBuffers,!p.getConfiguration('DEBUG',!1))return[3,5];r=[],n=0,l=0,o.label=1;case 1:return l<this.executionInfos.length?(i=this.executionInfos[l],s=performance.now(),[4,this.webgpuHandler.executeSinglePipelineState('descriptor.'+i.entry_func_name,i.threadgroups_per_grid,i.threads_per_thread_group,[e,t,a[l]],!0)]):[3,4];case 2:o.sent(),d=performance.now()-s,r.push({Kernel:i.entry_func_name,"Elapsed time [ms]":d}),n+=d,o.label=3;case 3:return l++,[3,1];case 4:return c=Array.from(Object.values(r.reduce(function(e,t){return t.Kernel in e||(e[t.Kernel]={Kernel:t.Kernel,Count:0,"Elapsed time [ms]":0}),e[t.Kernel].Count++,e[t.Kernel]['Elapsed time [ms]']+=t['Elapsed time [ms]'],e},{}))),c.forEach(function(e){return e['Ratio [%]']=(e['Elapsed time [ms]']/n).toFixed(2)}),console.table(r),console.table(c),[3,6];case 5:for(u=null,l=0;l<this.executionInfos.length;l++)i=this.executionInfos[l],h=l==this.executionInfos.length-1,u=this.webgpuHandler.executeSinglePipelineState('descriptor.'+i.entry_func_name,i.threadgroups_per_grid,i.threads_per_thread_group,[e,t,a[l]],h);return[2,u];case 6:return[2];}})})},t)}(f.DescriptorRunner);t.default=g},function(e,t,a){'use strict';function r(e){for(var a in e)t.hasOwnProperty(a)||(t[a]=e[a])}Object.defineProperty(t,'__esModule',{value:!0}),r(a(18)),r(a(41)),r(a(20))},function(e,t,a){'use strict';function r(e){return e instanceof Array?Array.prototype.concat.apply([],e.map(function(e){return r(e)})):e}function n(e){if('number'==typeof e)return[e,e,e,e];if(4==e.length)return[e[0],e[1],e[2],e[3]];if(3==e.length)return[e[0],e[1],e[2],e[0]];if(1==e.length)return[e[0],e[0],e[0],e[0]];throw new Error('bias and scale must be scalar number or array of length 1 or 3 or 4.')}function o(e,t){void 0===t&&(t={});var a=t.type,o=void 0===a?Float32Array:a,l=t.color,i=void 0===l?p.Color.RGB:l,s=t.order,d=void 0===s?p.Order.HWC:s,c=t.bias,u=void 0===c?[0,0,0]:c,f=t.scale,_=void 0===f?[1,1,1]:f,m=n(u),y=n(_),v=e.width,x=e.height,E=e.data,k,I,C,T,S,R,D,B,P;switch(i){case p.Color.RGB:switch(k=new o(3*(v*x)),R=y[0],D=y[1],B=y[2],I=m[0],C=m[1],T=m[2],d){case p.Order.HWC:for(var A=0;A<x;A++)for(var h=0;h<v;h++)k[3*(A*v+h)+0]=(E[4*(A*v+h)+0]-I)/R,k[3*(A*v+h)+1]=(E[4*(A*v+h)+1]-C)/D,k[3*(A*v+h)+2]=(E[4*(A*v+h)+2]-T)/B;break;case p.Order.CHW:for(var A=0;A<x;A++)for(var h=0;h<v;h++)k[(0*x+A)*v+h]=(E[4*(A*v+h)+0]-I)/R,k[(1*x+A)*v+h]=(E[4*(A*v+h)+1]-C)/D,k[(2*x+A)*v+h]=(E[4*(A*v+h)+2]-T)/B;}break;case p.Color.BGR:switch(k=new o(3*(v*x)),I=m[0],C=m[1],T=m[2],R=y[0],D=y[1],B=y[2],d){case p.Order.HWC:for(var A=0;A<x;A++)for(var h=0;h<v;h++)k[3*(A*v+h)+0]=(E[4*(A*v+h)+2]-T)/B,k[3*(A*v+h)+1]=(E[4*(A*v+h)+1]-C)/D,k[3*(A*v+h)+2]=(E[4*(A*v+h)+0]-I)/R;break;case p.Order.CHW:for(var A=0;A<x;A++)for(var h=0;h<v;h++)k[(0*x+A)*v+h]=(E[4*(A*v+h)+2]-T)/B,k[(1*x+A)*v+h]=(E[4*(A*v+h)+1]-C)/D,k[(2*x+A)*v+h]=(E[4*(A*v+h)+0]-I)/R;}break;case p.Color.RGBA:switch(k=new o(4*(v*x)),R=y[0],D=y[1],B=y[2],P=y[3],I=m[0],C=m[1],T=m[2],S=m[3],d){case p.Order.HWC:for(var A=0;A<x;A++)for(var h=0;h<v;h++)k[4*(A*v+h)+0]=(E[4*(A*v+h)+0]-I)/R,k[4*(A*v+h)+1]=(E[4*(A*v+h)+1]-C)/D,k[4*(A*v+h)+2]=(E[4*(A*v+h)+2]-T)/B,k[4*(A*v+h)+3]=(E[4*(A*v+h)+3]-S)/P;break;case p.Order.CHW:for(var A=0;A<x;A++)for(var h=0;h<v;h++)k[(0*x+A)*v+h]=(E[4*(A*v+h)+0]-I)/R,k[(1*x+A)*v+h]=(E[4*(A*v+h)+1]-C)/D,k[(2*x+A)*v+h]=(E[4*(A*v+h)+2]-T)/B,k[(3*x+A)*v+h]=(E[4*(A*v+h)+3]-S)/P;}break;case p.Color.BGRA:switch(k=new o(4*(v*x)),I=m[0],C=m[1],T=m[2],S=m[3],R=y[0],D=y[1],B=y[2],P=y[3],d){case p.Order.HWC:for(var A=0;A<x;A++)for(var h=0;h<v;h++)k[4*(A*v+h)+0]=(E[4*(A*v+h)+2]-T)/B,k[4*(A*v+h)+1]=(E[4*(A*v+h)+1]-C)/D,k[4*(A*v+h)+2]=(E[4*(A*v+h)+0]-I)/R,k[4*(A*v+h)+3]=(E[4*(A*v+h)+3]-S)/P;break;case p.Order.CHW:for(var A=0;A<x;A++)for(var h=0;h<v;h++)k[(0*x+A)*v+h]=(E[4*(A*v+h)+2]-T)/B,k[(1*x+A)*v+h]=(E[4*(A*v+h)+1]-C)/D,k[(2*x+A)*v+h]=(E[4*(A*v+h)+0]-I)/R,k[(3*x+A)*v+h]=(E[4*(A*v+h)+3]-S)/P;}break;case p.Color.GREY:k=new o(v*x),R=y[0],D=y[1],B=y[2],I=m[0],C=m[1],T=m[2];for(var A=0;A<x;A++)for(var h=0;h<v;h++){var w=E[4*(A*v+h)+0],r=E[4*(A*v+h)+1],g=E[4*(A*v+h)+2];k[A*v+h]=0.2126*(w-I)/R+0.7162*(r-C)/D+0.0722*(g-T)/B}break;default:throw Error('Unknown color format: '+i);}return k}function l(e,t){void 0===t&&(t={});var a=t.type,r=void 0===a?Float32Array:a,n=t.color,l=void 0===n?p.Color.RGB:n,i=t.order,s=void 0===i?p.Order.HWC:i,d=t.srcX,c=void 0===d?0:d,u=t.srcY,h=void 0===u?0:u,_=t.srcW,g=void 0===_?e.width:_,m=t.srcH,b=void 0===m?e.height:m,y=t.dstX,v=void 0===y?0:y,w=t.dstY,x=void 0===w?0:w,E=t.bias,k=void 0===E?[0,0,0]:E,I=t.scale,C=void 0===I?[1,1,1]:I,T=t.dstW,S=void 0===T?g:T,R=t.dstH,D=void 0===R?b:R,B=f.getImageData(e,{srcX:c,srcY:h,srcW:g,srcH:b,dstX:v,dstY:x,dstW:S,dstH:D});return o(B,{type:r,color:l,order:s,bias:k,scale:C})}function i(e,t){void 0===t&&(t={});var a,r;if(e instanceof HTMLVideoElement)a=e.videoWidth,r=e.videoHeight;else if(e instanceof HTMLImageElement)a=e.naturalWidth,r=e.naturalHeight;else{if(e instanceof HTMLCanvasElement)return l(e,t);if(e instanceof ImageData){var n=document.createElement('canvas');n.height=e.height,n.width=e.width;var o=u.getContext2D(n);return o.putImageData(e,0,0),l(n,t)}throw TypeError('Failed to execute "getImageDataFromDrawable(drawable, options)": "drawable" must be an instanceof Drawable')}var i=t.type,s=void 0===i?Float32Array:i,d=t.color,c=void 0===d?p.Color.RGB:d,h=t.order,f=void 0===h?p.Order.HWC:h,_=t.srcX,g=void 0===_?0:_,m=t.srcY,b=void 0===m?0:m,y=t.dstX,v=void 0===y?0:y,w=t.dstY,x=void 0===w?0:w,E=t.dstW,k=void 0===E?a:E,I=t.dstH,C=void 0===I?r:I,T=t.bias,S=void 0===T?[0,0,0]:T,R=t.scale,D=void 0===R?[1,1,1]:R,B=document.createElement('canvas');B.width=v+k,B.height=x+C;var P=u.getContext2D(B);return P.drawImage(e,g,b,a,r,v,x,k,C),l(B,{type:s,color:c,order:f,bias:S,scale:D})}function s(t,a,r){try{return new ImageData(t,a,r)}catch(i){console.warn('new ImageData failed: '+i);var n=document.createElement('canvas'),o=u.getContext2D(n),l=o.createImageData(a,r);return l.data.set(t),l}}var d=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r['throw'](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,i)}s((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,a){function r(e){return function(t){return o([e,t])}}function o(r){if(l)throw new TypeError('Generator is already executing.');for(;n;)try{if(l=1,i&&(s=i[2&r[0]?'return':r[0]?'throw':'next'])&&!(s=s.call(i,r[1])).done)return s;switch((i=0,s)&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,i=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if((s=n.trys,!(s=0<s.length&&s[s.length-1]))&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){n.label=r[1];break}if(6===r[0]&&n.label<s[1]){n.label=s[1],s=r;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(r);break}s[2]&&n.ops.pop(),n.trys.pop();continue;}r=a.call(e,n)}catch(t){r=[6,t],i=0}finally{l=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l,i,s,d;return d={next:r(0),throw:r(1),return:r(2)},'function'==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d};Object.defineProperty(t,'__esModule',{value:!0});var u=a(19),p=a(18),f=a(42),h=a(20);t.getImageArrayFromImageData=o,t.getImageArrayFromCanvas=l,t.getImageArrayFromDrawable=i,t.getImageArray=function(e,t){return void 0===t&&(t={}),d(this,void 0,void 0,function(){var a,r;return c(this,function(n){switch(n.label){case 0:return'string'==typeof e?(a=i,[4,h.loadImageByUrl(e)]):[3,2];case 1:return[2,a.apply(void 0,[n.sent(),t])];case 2:return e instanceof HTMLInputElement?(r=i,[4,h.loadImageFromFileInput(e)]):[3,4];case 3:return[2,r.apply(void 0,[n.sent(),t])];case 4:if(e instanceof HTMLCanvasElement)return[2,l(e,t)];if(e instanceof HTMLImageElement||e instanceof HTMLVideoElement||e instanceof ImageData)return[2,i(e,t)];throw TypeError('Failed to execute "getImageData(image, options)": "image" must be an instance of string, HTMLInputElement, HTMLCanvasElement, HTMLImageElement, HTMLVideoElement, or ImageData object');n.label=5;case 5:return[2];}})})},t.setImageArrayToCanvas=function(e,t,a,o,l){void 0===l&&(l={});var i=l.color,d=void 0===i?p.Color.RGB:i,c=l.order,u=void 0===c?p.Order.HWC:c,_=l.srcX,g=void 0===_?0:_,m=l.srcY,b=void 0===m?0:m,y=l.dstX,v=void 0===y?0:y,x=l.dstY,E=void 0===x?0:x,k=l.dstW,I=void 0===k?o.width:k,C=l.dstH,T=void 0===C?o.height:C,S=l.bias,R=void 0===S?[0,0,0]:S,D=l.scale,B=void 0===D?[1,1,1]:D,P=n(R),A=n(B),z=t,N=a;e=r(e);var O=new Uint8ClampedArray(4*(z*N)),L,M,F,U,W,j,H,G;switch(d){case p.Color.RGB:switch(L=P[0],M=P[1],F=P[2],W=A[0],j=A[1],H=A[2],u){case p.Order.HWC:for(var V=b;V<b+N;V++)for(var h=g;h<g+z;h++)O[4*(V*t+h)+0]=e[3*(V*t+h)+0]*W+L,O[4*(V*t+h)+1]=e[3*(V*t+h)+1]*j+M,O[4*(V*t+h)+2]=e[3*(V*t+h)+2]*H+F,O[4*(V*t+h)+3]=255;break;case p.Order.CHW:for(var V=b;V<b+N;V++)for(var h=g;h<g+z;h++)O[4*(V*t+h)+0]=e[(0*a+V)*t+h]*W+L,O[4*(V*t+h)+1]=e[(1*a+V)*t+h]*j+M,O[4*(V*t+h)+2]=e[(2*a+V)*t+h]*H+F,O[4*(V*t+h)+3]=255;}break;case p.Color.BGR:switch(L=P[0],M=P[1],F=P[2],W=A[0],j=A[1],H=A[2],u){case p.Order.HWC:for(var V=b;V<b+N;V++)for(var h=g;h<g+z;h++)O[4*(V*t+h)+0]=e[3*(V*t+h)+2]*W+L,O[4*(V*t+h)+1]=e[3*(V*t+h)+1]*j+M,O[4*(V*t+h)+2]=e[3*(V*t+h)+0]*H+F,O[4*(V*t+h)+3]=255;break;case p.Order.CHW:for(var V=b;V<b+N;V++)for(var h=g;h<g+z;h++)O[4*(V*t+h)+0]=e[(2*a+V)*t+h]*W+L,O[4*(V*t+h)+1]=e[(1*a+V)*t+h]*j+M,O[4*(V*t+h)+2]=e[(0*a+V)*t+h]*H+F,O[4*(V*t+h)+3]=255;}break;case p.Color.RGBA:switch(L=P[0],M=P[1],F=P[2],U=P[3],W=A[0],j=A[1],H=A[2],G=A[3],u){case p.Order.HWC:for(var V=b;V<b+N;V++)for(var h=g;h<g+z;h++)O[4*(V*t+h)+0]=e[3*(V*t+h)+0]*W+L,O[4*(V*t+h)+1]=e[3*(V*t+h)+1]*j+M,O[4*(V*t+h)+2]=e[3*(V*t+h)+2]*H+F,O[4*(V*t+h)+3]=e[3*(V*t+h)+3]*G+U;break;case p.Order.CHW:for(var V=b;V<b+N;V++)for(var h=g;h<g+z;h++)O[4*(V*t+h)+0]=e[(0*a+V)*t+h]*W+L,O[4*(V*t+h)+1]=e[(1*a+V)*t+h]*j+M,O[4*(V*t+h)+2]=e[(2*a+V)*t+h]*H+F,O[4*(V*t+h)+3]=e[(3*a+V)*t+h]*G+U;}break;case p.Color.BGRA:switch(L=P[0],M=P[1],F=P[2],U=P[3],W=A[0],j=A[1],H=A[2],G=A[3],u){case p.Order.HWC:for(var V=b;V<b+N;V++)for(var h=g;h<g+z;h++)O[4*(V*t+h)+0]=e[4*(V*t+h)+2]*W+L,O[4*(V*t+h)+1]=e[4*(V*t+h)+1]*j+M,O[4*(V*t+h)+2]=e[4*(V*t+h)+0]*H+F,O[4*(V*t+h)+3]=e[4*(V*t+h)+3]*G+U;break;case p.Order.CHW:for(var V=b;V<b+N;V++)for(var h=g;h<g+z;h++)O[4*(V*t+h)+0]=e[(2*a+V)*t+h]*W+L,O[4*(V*t+h)+1]=e[(1*a+V)*t+h]*j+M,O[4*(V*t+h)+2]=e[(0*a+V)*t+h]*H+F,O[4*(V*t+h)+3]=e[(3*a+V)*t+h]*G+U;}break;case p.Color.GREY:for(var V=b;V<b+N;V++)for(var h=g;h<g+z;h++)O[4*(V*t+h)+0]=O[4*(V*t+h)+1]=O[4*(V*t+h)+2]=e[V*t+h]*B[0]+R[0],O[4*(V*t+h)+3]=255;}f.setImageDataToCanvas(s(O,z,N),o,{srcX:g,srcY:b,srcW:z,srcH:N,dstX:v,dstY:E,dstW:I,dstH:T})}},function(e,t,a){'use strict';function r(e,t){void 0===t&&(t={});var a=t.srcX,r=void 0===a?0:a,n=t.srcY,i=void 0===n?0:n,s=t.srcW,d=void 0===s?e.width:s,c=t.srcH,u=void 0===c?e.height:c,p=t.dstX,h=void 0===p?0:p,f=t.dstY,_=void 0===f?0:f,g=t.dstW,m=void 0===g?d:g,b=t.dstH,y=void 0===b?u:b,v=l.getContext2D(e).getImageData(r,i,d,u);return(0!==h||0!==_||d!==m||u!==y)&&(v=o(v,{dstX:h,dstY:_,dstW:m,dstH:y})),v}function n(e,t){void 0===t&&(t={});var a,r;if(e instanceof HTMLVideoElement)a=e.videoWidth,r=e.videoHeight;else if(e instanceof HTMLImageElement)a=e.naturalWidth,r=e.naturalHeight;else throw TypeError('Failed to execute "getImageDataFromDrawable(drawable, options)": "drawable" must be an instanceof HTMLVideoElement or HTMLImageElement');var n=t.srcX,o=void 0===n?0:n,i=t.srcY,s=void 0===i?0:i,d=t.dstX,c=void 0===d?0:d,u=t.dstY,p=void 0===u?0:u,h=t.dstW,f=void 0===h?a:h,_=t.dstH,g=void 0===_?r:_,m=document.createElement('canvas');m.width=c+f,m.height=p+g;var b=l.getContext2D(m);return b.drawImage(e,o,s,a,r,c,p,f,g),b.getImageData(0,0,c+f,p+g)}function o(e,t){void 0===t&&(t={});var a=t.srcX,r=void 0===a?0:a,n=t.srcY,o=void 0===n?0:n,i=t.srcW,s=void 0===i?e.width:i,d=t.srcH,c=void 0===d?e.height:d,u=t.dstX,p=void 0===u?0:u,h=t.dstY,f=void 0===h?0:h,_=t.dstW,g=void 0===_?s:_,m=t.dstH,b=void 0===m?c:m,y=document.createElement('canvas');y.width=s,y.height=c;var v=l.getContext2D(y);v.putImageData(e,-r,-o);var w=document.createElement('canvas');w.width=p+g,w.height=f+b;var x=l.getContext2D(w);return x.drawImage(y,0,0,s,c,p,f,g,b),x.getImageData(0,0,p+g,f+b)}Object.defineProperty(t,'__esModule',{value:!0});var l=a(19);t.getImageDataFromCanvas=r,t.getImageDataFromDrawable=n,t.getImageData=function(e,t){if(void 0===t&&(t={}),e instanceof HTMLCanvasElement)return r(e,t);if(e instanceof HTMLVideoElement||e instanceof HTMLImageElement)return n(e,t);throw TypeError('Failed to execute "getImageData(image, options)": "image" must be an instance of HTMLCanvasElement, HTMLVideoElement, or HTMLImageElement')},t.setImageDataToCanvas=function(e,t,a){void 0===a&&(a={});var r=a.srcX,n=void 0===r?0:r,i=a.srcY,s=void 0===i?0:i,d=a.srcW,c=void 0===d?e.width:d,u=a.srcH,p=void 0===u?e.height:u,h=a.dstX,f=void 0===h?0:h,_=a.dstY,g=void 0===_?0:_,m=a.dstW,b=void 0===m?c:m,y=a.dstH,v=void 0===y?p:y;(0!==n||0!==s||c!==b||p!==v)&&(e=o(e,{srcX:n,srcY:s,srcW:c,srcH:p,dstW:b,dstH:v})),l.getContext2D(t).putImageData(e,f,g)}},function(e,t,a){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),function(e){for(var a in e)t.hasOwnProperty(a)||(t[a]=e[a])}(a(44))},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.argmax=function(e,t){void 0===t&&(t=1),e=e.slice();for(var a=[[0,e.length]],r=[],n=0;n<e.length;n++)r[n]=n;for(;0<a.length;){var o=a.pop(),l=o[0],i=o[1],s=e[i-1],d=l,c=i-2,u=void 0;if(!(l>=i-1)){for(;;){for(;e[d]>s&&d<=c;)d++;for(;e[c]<=s&&d<=c;)c--;if(d>=c)break;u=e[d],e[d]=e[c],e[c]=u,u=r[d],r[d]=r[c],r[c]=u}e[i-1]=e[d],e[d]=s,u=r[i-1],r[i-1]=r[d],r[d]=u,a.push([l,d]),d+1<t&&a.push([d+1,i])}}for(var p=[],n=0;n<t;n++)p.push(r[n]);return p},t.argmin=function(e,t){void 0===t&&(t=1),e=e.slice();for(var a=[[0,e.length]],r=[],n=0;n<e.length;n++)r[n]=n;for(;0<a.length;){var o=a.pop(),l=o[0],i=o[1],s=e[i-1],d=l,c=i-2,u=void 0;if(!(l>=i-1)){for(;;){for(;e[d]<s&&d<=c;)d++;for(;e[c]>=s&&d<=c;)c--;if(d>=c)break;u=e[d],e[d]=e[c],e[c]=u,u=r[d],r[d]=r[c],r[c]=u}e[i-1]=e[d],e[d]=s,u=r[i-1],r[i-1]=r[d],r[d]=u,a.push([l,d]),d+1<t&&a.push([d+1,i])}}for(var p=[],n=0;n<t;n++)p.push(r[n]);return p}}])});
//# sourceMappingURL=webdnn.es5.js.map